/*! For license information please see 673.bundle.js.LICENSE.txt */
(self.webpackChunksteltrek_project=self.webpackChunksteltrek_project||[]).push([[673],{673:()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(){"use strict";t=function(){return i};var n,i={},r=Object.prototype,o=r.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(n){d=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var r=t&&t.prototype instanceof b?t:b,o=Object.create(r.prototype),a=new P(i||[]);return s(o,"_invoke",{value:_(e,n,a)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}i.wrap=h;var m="suspendedStart",g="suspendedYield",y="executing",f="completed",v={};function b(){}function w(){}function x(){}var k={};d(k,c,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(q([])));S&&S!==r&&o.call(S,c)&&(k=S);var M=x.prototype=b.prototype=Object.create(k);function T(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function L(t,n){function i(r,s,a,c){var u=p(t[r],t,s);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==e(d)&&o.call(d,"__await")?n.resolve(d.__await).then((function(e){i("next",e,a,c)}),(function(e){i("throw",e,a,c)})):n.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,c)}))}c(u.arg)}var r;s(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,r){i(e,t,n,r)}))}return r=r?r.then(o,o):o()}})}function _(e,t,i){var r=m;return function(o,s){if(r===y)throw Error("Generator is already running");if(r===f){if("throw"===o)throw s;return{value:n,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var c=C(a,i);if(c){if(c===v)continue;return c}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===m)throw r=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=y;var u=p(e,t,i);if("normal"===u.type){if(r=i.done?f:g,u.arg===v)continue;return{value:u.arg,done:i.done}}"throw"===u.type&&(r=f,i.method="throw",i.arg=u.arg)}}}function C(e,t){var i=t.method,r=e.iterator[i];if(r===n)return t.delegate=null,"throw"===i&&e.iterator.return&&(t.method="return",t.arg=n,C(e,t),"throw"===t.method)||"return"!==i&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+i+"' method")),v;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,v;var s=o.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function q(t){if(t||""===t){var i=t[c];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function e(){for(;++r<t.length;)if(o.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return s.next=s}}throw new TypeError(e(t)+" is not iterable")}return w.prototype=x,s(M,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:w,configurable:!0}),w.displayName=d(x,l,"GeneratorFunction"),i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,d(e,l,"GeneratorFunction")),e.prototype=Object.create(M),e},i.awrap=function(e){return{__await:e}},T(L.prototype),d(L.prototype,u,(function(){return this})),i.AsyncIterator=L,i.async=function(e,t,n,r,o){void 0===o&&(o=Promise);var s=new L(h(e,t,n,r),o);return i.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},T(M),d(M,l,"Generator"),d(M,c,(function(){return this})),d(M,"toString",(function(){return"[object Generator]"})),i.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},i.values=q,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(i,r){return a.type="throw",a.arg=e,t.next=i,r&&(t.method="next",t.arg=n),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;A(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:q(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=n),v}},i}function n(e,t,n,i,r,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function i(e){return function(){var t=this,i=arguments;return new Promise((function(r,o){var s=e.apply(t,i);function a(e){n(s,r,o,a,c,"next",e)}function c(e){n(s,r,o,a,c,"throw",e)}a(void 0)}))}}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,c(i.key),i)}}function c(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}window.StellaCore||(window.StellaCore=function(){return e=function e(){var t,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=o({statusSelector:"#stella-status",messageSelector:"#stella-status-message",guidanceSelector:"#stella-guidance",modalSelector:"#stella-help-modal",conversationSelector:".stella-conversation",inputSelector:"#stella-question",sendButtonSelector:"#send-to-stella",expandButtonSelector:"#expand-stella",missionSelector:"#mission-progress-bar",countdownSelector:"#space-countdown",debugMode:!1,mockApi:!0},i),this.connected=!1,this.currentModuleType=(null===(t=document.querySelector("[data-module]"))||void 0===t?void 0:t.dataset.module)||"physical",this.currentMission=(null===(n=document.querySelector("[data-mission]"))||void 0===n?void 0:n.dataset.mission)||"core-balance",this.sessionMetrics={heartRate:0,o2Saturation:98,focusScore:75,progressPercentage:0,balance:65,coreStability:70,endurance:60,formQuality:75,vestibularAdaptation:60,missionProgress:0},this.guidanceHistory=[],this.userQuestions=[],this.offlineMode=!1,this.initialize(),this.options.debugMode&&console.log("STELLA Core initialized with options:",this.options)},n=[{key:"initialize",value:function(){var e=this;this.statusElement=document.querySelector(this.options.statusSelector),this.messageElement=document.querySelector(this.options.messageSelector),this.guidanceElement=document.querySelector(this.options.guidanceSelector),this.modalElement=document.querySelector(this.options.modalSelector),this.conversationElement=document.querySelector(this.options.conversationSelector),this.inputElement=document.querySelector(this.options.inputSelector),this.sendButton=document.querySelector(this.options.sendButtonSelector),this.expandButton=document.querySelector(this.options.expandButtonSelector),this.missionProgressElement=document.querySelector(this.options.missionSelector),this.countdownElement=document.querySelector(this.options.countdownSelector),this._loadUserQuestions(),this._setupEventListeners(),this._updateStatus("connecting"),this._connectToBackend().then((function(){e._updateStatus("connected"),e._fetchUserInfo(),e._showWelcomeMessage()})).catch((function(t){console.error("Failed to connect to STELLA backend:",t),e._updateStatus("error"),e.offlineMode=!0,e._showWelcomeMessage()})),window.STELLA=this,document.addEventListener("mission-progress-update",(function(t){return e._handleMissionProgressUpdate(t.detail)})),document.addEventListener("exercise-completed",(function(t){return e._handleExerciseCompleted(t.detail)})),document.addEventListener("session-started",(function(t){return e._handleSessionStarted(t.detail)})),document.addEventListener("session-completed",(function(t){return e._handleSessionCompleted(t.detail)}))}},{key:"getGuidance",value:(u=i(t().mark((function e(n){var i,r,s,a,c,u,l,d=arguments;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>1&&void 0!==d[1]?d[1]:{},e.prev=1,this.options.debugMode&&console.log("Getting guidance for ".concat(n," with metrics:"),i),r=o(o({},this.sessionMetrics),i),this.sessionMetrics=r,!1===this.options.mockApi&&!this.offlineMode){e.next=7;break}return e.abrupt("return",this._getMockGuidance(n,r));case 7:s=0,a=3;case 9:if(!(s<a)){e.next=34;break}return e.prev=10,e.next=13,fetch("/api/ai/guidance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({activity:n,metrics:r,module:this.currentModuleType,mission:this.currentMission})});case 13:if((c=e.sent).ok){e.next=16;break}throw new Error("Failed to get guidance: ".concat(c.status));case 16:return e.next=18,c.json();case 18:return u=e.sent,this._addToGuidanceHistory(n,u),this._updateGuidance(u),this._dispatchGuidanceEvent(u),e.abrupt("return",u);case 25:if(e.prev=25,e.t0=e.catch(10),!(++s>=a)){e.next=30;break}throw e.t0;case 30:return e.next=32,new Promise((function(e){return setTimeout(e,1e3*s)}));case 32:e.next=9;break;case 34:e.next=44;break;case 36:return e.prev=36,e.t1=e.catch(1),console.error("Error getting STELLA guidance:",e.t1),this.offlineMode=!0,l={message:"I'm currently operating in offline mode. Focus on maintaining proper form and steady breathing during your exercises.",actionItems:["Monitor your breathing","Maintain proper posture","Stay hydrated"],source:"fallback"},this._updateGuidance(l),this._dispatchGuidanceEvent(l),e.abrupt("return",l);case 44:case"end":return e.stop()}}),e,this,[[1,36],[10,25]])}))),function(e){return u.apply(this,arguments)})},{key:"askQuestion",value:(c=i(t().mark((function e(n){var i,r,o,s,a,c,u;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n.trim()){e.next=2;break}return e.abrupt("return",null);case 2:if(this._trackUserQuestion(n),e.prev=3,this._addMessageToConversation(n,"user"),this._updateStatus("busy"),!1===this.options.mockApi&&!this.offlineMode){e.next=12;break}return e.next=9,new Promise((function(e){return setTimeout(e,800)}));case 9:return i=this._getMockResponse(n),this._updateStatus("connected"),e.abrupt("return",i);case 12:r=0,o=3;case 14:if(!(r<o)){e.next=39;break}return e.prev=15,e.next=18,fetch("/api/ai/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:n,context:{module:this.currentModuleType,mission:this.currentMission,metrics:this.sessionMetrics}})});case 18:if((s=e.sent).ok){e.next=21;break}throw new Error("Failed to get response: ".concat(s.status));case 21:return e.next=23,s.json();case 23:return a=e.sent,c=a.answer,this._addMessageToConversation(c,"stella"),this._updateStatus("connected"),e.abrupt("return",c);case 30:if(e.prev=30,e.t0=e.catch(15),!(++r>=o)){e.next=35;break}throw e.t0;case 35:return e.next=37,new Promise((function(e){return setTimeout(e,1e3*r)}));case 37:e.next=14;break;case 39:e.next=49;break;case 41:return e.prev=41,e.t1=e.catch(3),console.error("Error asking STELLA:",e.t1),this.offlineMode=!0,this._updateStatus("error"),u="I'm currently operating in offline mode, but I can still assist with your training. Let's focus on your current mission objectives while my connection is restored.",this._addMessageToConversation(u,"stella"),e.abrupt("return",u);case 49:case"end":return e.stop()}}),e,this,[[3,41],[15,30]])}))),function(e){return c.apply(this,arguments)})},{key:"updateMetrics",value:function(e){e&&(this.options.debugMode&&console.log("Updating STELLA metrics:",e),this.sessionMetrics=o(o({},this.sessionMetrics),e),void 0!==e.missionProgress&&this.missionProgressElement&&(this.missionProgressElement.style.width="".concat(e.missionProgress,"%")),void 0!==e.countdown&&this.countdownElement&&(this.countdownElement.textContent="".concat(e.countdown," Days")),this._dispatchMetricsEvent(this.sessionMetrics),this._shouldTriggerGuidance(e)&&this.getGuidance("metrics-update",this.sessionMetrics))}},{key:"_shouldTriggerGuidance",value:function(e){return!!(e.heartRate&&Math.abs(e.heartRate-(this.sessionMetrics.heartRate||0))>15)||!!(e.formQuality&&Math.abs(e.formQuality-(this.sessionMetrics.formQuality||0))>10)||!!(e.missionProgress&&Math.floor(e.missionProgress/25)>Math.floor((this.sessionMetrics.missionProgress||0)/25))}},{key:"showModal",value:function(){this.modalElement&&this.modalElement.classList.remove("hidden")}},{key:"hideModal",value:function(){this.modalElement&&this.modalElement.classList.add("hidden")}},{key:"getPersonalizedRecommendations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o(o({},this.sessionMetrics),e),{focusAreas:["Vestibular adaptation training","Upper body strength for EVA readiness","Core stability for microgravity adaptation"],nextModules:[{id:"vestibular-04",name:"Advanced Vestibular Training",priority:"high"},{id:"strength-07",name:"EVA-Specific Strength Development",priority:"medium"},{id:"core-05",name:"Microgravity Core Stabilization",priority:"medium"}],nutritionTips:["Increase calcium intake to support bone density","Optimize protein timing around resistance training","Ensure adequate hydration for vestibular sessions"],recoveryStrategies:["Contrast therapy post-session","Vestibular reset exercises before sleep","Full recovery day post Module 3.2"]}}},{key:"analyzeTrainingSession",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=.4*(e.formQuality||70)+.6*(e.intensity||65),n=.5*(e.heartRateControl||75)+.5*(e.durationPercentage||80),i=.7*(e.stabilityMetrics||65)+.3*(e.adaptationRate||60);return{overallScore:Math.round((t+n+i)/3),strengths:[t>75?"Excellent form maintenance":null,n>75?"Strong cardiovascular performance":null,i>75?"Superior vestibular adaptation":null].filter(Boolean),improvementAreas:[t<70?"Focus on consistent form during fatigue":null,n<70?"Work on heart rate recovery between intervals":null,i<70?"Increase duration of vestibular challenges":null].filter(Boolean),recommendations:["Increase hydration during similar future sessions","Consider adding 5 minutes to your cool-down protocol",t<n?"Prioritize resistance training in next session":"Maintain training balance"]}}},{key:"_handleMissionProgressUpdate",value:function(e){e&&(this.options.debugMode&&console.log("Mission progress update:",e),this.updateMetrics({missionProgress:e.progress||0}),!e.progress||25!==e.progress&&50!==e.progress&&75!==e.progress&&100!==e.progress||this.getGuidance("progress-milestone",{progress:e.progress,milestone:Math.floor(e.progress/25)}))}},{key:"_handleExerciseCompleted",value:function(e){e&&(this.options.debugMode&&console.log("Exercise completed:",e),this.getGuidance("exercise-completed",{exerciseId:e.id,duration:e.duration,performance:e.performance||"good"}))}},{key:"_handleSessionStarted",value:function(e){e&&(this.options.debugMode&&console.log("Session started:",e),this.getGuidance("session-start",{sessionId:e.id,sessionType:e.type}))}},{key:"_handleSessionCompleted",value:function(e){e&&(this.options.debugMode&&console.log("Session completed:",e),this.getGuidance("session-end",{sessionId:e.id,sessionDuration:e.duration,sessionEffectiveness:e.effectiveness||85,exercisesCompleted:e.exercisesCompleted||[]}))}},{key:"_showWelcomeMessage",value:function(){var e;switch(this.currentModuleType){case"physical":e="Welcome to your Physical Training module. I'm STELLA, your space training AI assistant. I'll guide you through exercises that prepare your body for the unique challenges of microgravity environments.";break;case"technical":e="Welcome to Technical Training. I'll assist you in mastering the critical technical skills required for spacecraft operations and emergency procedures.";break;case"mental":e="Welcome to Mental Fitness training. I'll guide you through cognitive exercises designed to enhance your decision-making, stress management, and mental resilience in space.";break;default:e="Welcome to SharedStars Academy. I'm STELLA, your AI training assistant. I'll guide your preparation for space through personalized training and real-time feedback."}this.guidanceElement&&this._updateGuidance({message:e,actionItems:["Complete your initial assessment","Follow the training sequence for optimal results","Ask me questions anytime during your training"]})}},{key:"_setupEventListeners",value:function(){var e=this;this.sendButton&&this.inputElement&&this.sendButton.addEventListener("click",(function(){var t=e.inputElement.value.trim();t&&(e.askQuestion(t),e.inputElement.value="")})),this.inputElement&&this.inputElement.addEventListener("keydown",(function(t){if("Enter"===t.key){var n=e.inputElement.value.trim();n&&(e.askQuestion(n),e.inputElement.value="")}}));var t=document.getElementById("close-stella-modal");t&&t.addEventListener("click",(function(){e.hideModal()}));var n=document.getElementById("ai-help-button");n&&n.addEventListener("click",(function(){e.showModal()})),this.expandButton&&this.expandButton.addEventListener("click",(function(){var t=document.getElementById("stella-interface");t&&(t.classList.toggle("expanded"),e.expandButton.innerHTML=t.classList.contains("expanded")?'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>':'<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16"/></svg>')})),document.querySelectorAll("[data-stella-guidance]").forEach((function(t){t.addEventListener("click",(function(){var n=t.dataset.stellaGuidance;n&&e.getGuidance(n)}))}))}},{key:"_connectToBackend",value:(s=i(t().mark((function e(){var n,i,r,o=this;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===this.options.mockApi){e.next=2;break}return e.abrupt("return",new Promise((function(e){setTimeout((function(){o.connected=!0,e(!0)}),1e3)})));case 2:return e.prev=2,e.next=5,fetch("/api/ai/status");case 5:if((n=e.sent).ok){e.next=8;break}throw new Error("Failed to connect: ".concat(n.status));case 8:return e.next=10,n.json();case 10:return i=e.sent,r=i.status,this.connected="online"===r,e.abrupt("return",this.connected);case 16:throw e.prev=16,e.t0=e.catch(2),console.error("Error connecting to STELLA backend:",e.t0),this.connected=!1,e.t0;case 21:case"end":return e.stop()}}),e,this,[[2,16]])}))),function(){return s.apply(this,arguments)})},{key:"_fetchUserInfo",value:(r=i(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===this.options.mockApi){e.next=2;break}return e.abrupt("return",{level:"beginner",progress:25,strengths:["dedication","consistency"],weaknesses:["balance","core stability"]});case 2:return e.prev=2,e.next=5,fetch("/api/user/profile");case 5:if((n=e.sent).ok){e.next=8;break}throw new Error("Failed to fetch user info: ".concat(n.status));case 8:return e.next=10,n.json();case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(2),console.error("Error fetching user info:",e.t0),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this,[[2,13]])}))),function(){return r.apply(this,arguments)})},{key:"_updateStatus",value:function(e){if(this.statusElement)switch(this.statusElement.classList.remove("bg-green-500","bg-yellow-500","bg-red-500","bg-blue-500"),e){case"connected":this.statusElement.classList.add("bg-green-500"),this.messageElement&&(this.messageElement.innerHTML='STELLA: <span class="text-blue-400">Online and ready</span>');break;case"connecting":this.statusElement.classList.add("bg-blue-500"),this.messageElement&&(this.messageElement.innerHTML='STELLA: <span class="text-blue-400">Connecting...</span>');break;case"busy":this.statusElement.classList.add("bg-yellow-500"),this.messageElement&&(this.messageElement.innerHTML='STELLA: <span class="text-yellow-400">Processing...</span>');break;case"error":this.statusElement.classList.add("bg-red-500"),this.messageElement&&(this.messageElement.innerHTML=this.offlineMode?'STELLA: <span class="text-red-400">Offline mode</span>':'STELLA: <span class="text-red-400">Connection error</span>');break;default:this.statusElement.classList.add("bg-blue-500"),this.messageElement&&(this.messageElement.innerHTML='STELLA: <span class="text-blue-400">Standing by</span>')}}},{key:"_updateGuidance",value:function(e){if(this.guidanceElement)if(e&&e.message){var t=e.actionItems&&e.actionItems.length?'<ul class="mt-2 space-y-1 list-disc list-inside">\n              '.concat(e.actionItems.map((function(e){return'<li class="text-xs text-blue-200">â€¢ '.concat(e,"</li>")})).join(""),"\n            </ul>"):"";this.guidanceElement.innerHTML='\n          <div class="bg-blue-500/10 rounded-lg p-3">\n            <p class="text-sm text-blue-300">'.concat(e.message,"</p>\n            ").concat(t,"\n          </div>\n        ")}else this.guidanceElement.innerHTML='\n          <div class="bg-blue-500/10 rounded-lg p-3">\n            <p class="text-sm text-blue-300">I\'m monitoring your activity and will provide guidance as you train.</p>\n          </div>\n        '}},{key:"_addMessageToConversation",value:function(e,t){if(this.conversationElement){var n="user"===t?"text-right":"",i="user"===t?"bg-blue-600 ml-auto":"bg-gray-700";this.conversationElement.innerHTML+='\n        <div class="mb-2 '.concat(n,'">\n          <div class="inline-block ').concat(i,' px-3 py-2 rounded-lg max-w-xs">\n            ').concat(e,"\n          </div>\n        </div>\n      "),this.conversationElement.scrollTop=this.conversationElement.scrollHeight}}},{key:"_addToGuidanceHistory",value:function(e,t){this.guidanceHistory.push({timestamp:(new Date).toISOString(),activity:e,guidance:t}),this.guidanceHistory.length>50&&(this.guidanceHistory=this.guidanceHistory.slice(-50))}},{key:"_loadUserQuestions",value:function(){if(window.localStorage)try{var e=localStorage.getItem("stella_user_questions");e&&(this.userQuestions=JSON.parse(e))}catch(e){console.warn("Error loading user questions:",e),this.userQuestions=[]}}},{key:"_dispatchGuidanceEvent",value:function(e){var t=new CustomEvent("stella-guidance",{detail:{guidance:e}});document.dispatchEvent(t)}},{key:"_dispatchMetricsEvent",value:function(e){var t=new CustomEvent("stella-metrics-update",{detail:{metrics:e}});document.dispatchEvent(t)}},{key:"_trackUserQuestion",value:function(e){var t=this;if(this.userQuestions.push({question:e,timestamp:(new Date).toISOString()}),this.userQuestions.length>50&&(this.userQuestions=this.userQuestions.slice(-50)),window.localStorage)try{localStorage.setItem("stella_user_questions",JSON.stringify(this.userQuestions))}catch(e){console.warn("Error storing user question:",e)}this.offlineMode||this.options.mockApi||fetch("/api/ai/track-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})}).catch((function(e){t.options.debugMode&&console.warn("Failed to send question to learning system:",e)}))}},{key:"_getMockGuidance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.heartRate&&t.heartRate>160)return{message:"Your heart rate is elevated. Consider taking a short recovery break to bring it down to a more sustainable level.",actionItems:["Focus on deep, controlled breathing","Hydrate adequately","Reduce intensity until heart rate stabilizes"],priority:"high"};if(t.formQuality&&t.formQuality<70)return{message:"I've detected some form inconsistencies. Let's focus on technique before increasing intensity.",actionItems:["Slow down your movements for better control","Focus on proper alignment in each position","Consider reducing resistance/weight to master form first"],priority:"medium"};switch(e){case"balance":return{message:"I'm monitoring your balance training. Focus on engaging your core muscles and maintaining stability throughout each exercise.",actionItems:["Keep your spine neutral during planks","Breathe steadily and deeply","Engage your core throughout all exercises"],priority:"normal"};case"endurance":var n=t.endurance||50,i=t.heartRate?t.heartRate<140?"below target":t.heartRate>150?"above target":"on target":"unknown";return{message:"I'm monitoring your cardiovascular metrics. Your endurance level is ".concat(n,"% and heart rate is ").concat(i,". ").concat("on target"===i?"Maintain this pace for optimal training.":"Adjust your intensity to reach your target zone."),actionItems:["Maintain a steady breathing pattern","Stay hydrated throughout your session","Monitor your heart rate recovery between intervals"],priority:"above target"===i?"medium":"normal"};case"exercise":switch(t.exerciseId||""){case"planks":return{message:"For plank exercises, focus on maintaining a straight line from head to heels. This position is crucial for EVA operations when you need to maintain position against reaction forces.",actionItems:["Engage your core by pulling your belly button toward your spine","Keep your neck in a neutral position - imagine your space helmet position","Distribute your weight evenly as you would in a balanced EVA position"],priority:"normal",relatedExercises:["side-planks","dynamic-planks"]};case"stability-ball":return{message:"Stability ball exercises mimic the constant adjustments needed in microgravity. Focus on controlled movements and core engagement.",actionItems:["Move slowly and deliberately as you would during in-space operations","Maintain awareness of your entire body position","Practice small corrections - essential for station keeping in EVA"],priority:"normal",relatedExercises:["bosu-balance","swiss-ball-pikes"]};case"single-leg":return{message:"Single-leg exercises train your vestibular system to maintain orientation without normal gravity cues - critical for spacewalks.",actionItems:["Focus on a fixed point like you would on a spacecraft reference point","Practice smooth transitions between positions","Maintain awareness of your center of gravity"],priority:"normal",relatedExercises:["single-leg-deadlift","pistol-squats"]};case"hollow-hold":return{message:"The hollow hold position trains the same core muscles used to maintain body position during launch and reentry. Note how this engages your entire anterior chain.",actionItems:["Press your lower back into the floor throughout the exercise","Keep your shoulders slightly lifted but relaxed","Maintain consistent breathing pattern - essential during high-G phases"],priority:"high",relatedExercises:["v-ups","tuck-holds"]};case"rotation-training":return{message:'Rotational exercises prepare your vestibular system for the disorientation many astronauts experience in microgravity. The space station has no fixed "up" or "down".',actionItems:["Move through each rotation slowly at first, then increase speed","Keep your eyes open to train visual reorientation","Practice reestablishing your reference frame after each rotation"],priority:"high",relatedExercises:["vestibular-ball-work","orientation-drills"]};default:return{message:"I'm monitoring your form and performance. Each exercise in this program is designed to prepare specific physiological systems for spaceflight demands.",actionItems:["Focus on quality over quantity - space operations require precision","Maintain proper breathing techniques throughout","Visualize how this movement relates to space operations"],priority:"normal"}}case"session-start":var r=t.userName||"Cadet";return{message:"Welcome to your Core & Balance training session, ".concat(r,". This session focuses on developing the stability needed in microgravity environments. I'll be monitoring your form and providing real-time guidance."),actionItems:["Begin with the vestibular calibration exercises (30 seconds each)","Focus on form quality rather than repetitions","Remember to hydrate - fluid distribution changes significantly in space"],priority:"normal",sessionType:t.sessionType||"core-balance"};case"session-end":var o=this._calculateSessionEffectiveness(t);return{message:"Great work! You've completed your Core & Balance training with ".concat(o>85?"excellent":o>70?"good":o>50?"moderate":"needs improvement"," effectiveness. Your vestibular adaptation metrics show improvement, which will be crucial for your orientation in microgravity."),actionItems:["Complete the vestibular re-calibration exercises","Log your session notes while the experience is fresh","Your next training session is recommended in 48 hours"],priority:"normal",sessionStats:{duration:t.sessionDuration||"00:30:00",effectiveness:o,vestibularAdaptation:t.vestibularAdaptation||75,coreStrength:t.coreStrength||80}};case"progress-milestone":var s=t.milestone||1;return{message:["You've completed 25% of your Core & Balance mission. Your dedicated training is building the foundation needed for space operations.","Halfway through your Core & Balance mission! Your vestibular metrics show a 15% improvement since you started.","You've reached 75% completion of your Core & Balance mission. Your progress demonstrates the consistent training essential for astronaut preparation.","Congratulations on completing your Core & Balance mission! This foundational training will support all future space operations training."][s-1]||"You're making great progress in your training mission.",actionItems:["Review your progress metrics in your training log","Consider increasing challenge level for exercises you find easy","Continue consistent practice for optimal adaptation"],priority:"normal",milestone:s};case"exercise-completed":var a=t.exerciseId||"this exercise";return{message:"You've completed ".concat(a,"! This exercise specifically develops the ").concat(a.includes("plank")?"core stability":a.includes("balance")?"vestibular adaptation":"neuromuscular control"," needed for ").concat(a.includes("plank")?"maintaining position during EVA operations":a.includes("balance")?"orientation in variable gravity":"precise movement control in space","."),actionItems:["Take 30 seconds to recover before your next exercise","Note any areas of difficulty for focused training","Hydrate between exercises to maintain optimal performance"],priority:"normal",exerciseMetrics:{duration:t.duration||"00:01:30",formQuality:t.formQuality||85,difficultyRating:t.difficulty||"moderate"}};case"metrics-update":var c="I'm monitoring your training metrics. ";return t.heartRate>150?c+="Your elevated heart rate indicates high exertion. Consider whether this intensity is sustainable for your training phase.":t.formQuality<70?c+="I've detected some form inconsistencies. Quality of movement is more important than quantity for space preparation.":t.vestibularAdaptation>80?c+="Your vestibular adaptation score is excellent. You're developing the neural pathways needed to quickly adapt to changing gravity conditions.":c+="Your metrics are within expected ranges for this training phase. Continue focusing on quality execution.",{message:c,actionItems:["Focus on maintaining proper form throughout all exercises","Your vestibular adaptation is the primary focus of this mission","Track your subjective experience along with objective metrics"],priority:"normal"};default:return{message:"I'm here to guide your space training. Your Core & Balance foundation will prepare critical physiological systems for the unique challenges of spaceflight.",actionItems:["Focus on form quality in all exercises","Pay attention to how your vestibular system responds","Track your progress to see your adaptation over time"],priority:"normal"}}}},{key:"_calculateSessionEffectiveness",value:function(e){var t=e.heartRateConsistency||75,n=e.formQuality||70,i=e.timeInTargetZone||65,r=e.exerciseCompletion||80,o=e.focusScore||75;return Math.round(.2*t+.25*n+.25*i+.15*r+.15*o)}},{key:"_getMockResponse",value:function(e){var t=e.toLowerCase();if(t.includes("assessment")||t.includes("initial test")){var n="The Core & Balance assessment evaluates your current vestibular adaptation and core stability baseline. It contains exercises that test your ability to maintain position and balance in conditions that simulate aspects of microgravity. Complete this assessment first so I can customize your training program based on your specific needs.";return this._addMessageToConversation(n,"stella"),n}if(t.includes("core")||t.includes("strength")){var i="Core strength is critical for astronauts. In microgravity, your core muscles no longer work against gravity, leading to weakening. Additionally, a strong core is essential for controlling your position during EVA operations and withstanding the G-forces during launch and reentry. The exercises in this mission specifically target the deep stabilizing muscles needed for space operations.";return this._addMessageToConversation(i,"stella"),i}if(t.includes("balance")||t.includes("dizzy")||t.includes("vestibular")){var r="Balance training is essential because your vestibular system will need to recalibrate in microgravity. Astronauts report that the first days in space often include disorientation and space sickness as the brain learns to interpret sensory input differently. These exercises help train your brain to rely less on gravity-dependent signals and more on visual and proprioceptive cues - exactly what you'll need in space.";return this._addMessageToConversation(r,"stella"),r}if(t.includes("progress")||t.includes("improving")||t.includes("better")){var o="You're making good progress in your Core & Balance training! Your vestibular adaptation metrics have improved by approximately 12% since your initial assessment, and your core stability metrics are showing steady improvement. Continue focusing on the exercises that challenge you most, as these represent your greatest opportunities for improvement.";return this._addMessageToConversation(o,"stella"),o}if(t.includes("why")&&(t.includes("important")||t.includes("necessary")||t.includes("need"))){var s="This training is critical because space environments present unique challenges to the human body. Without gravity, your muscles - especially your core - atrophy rapidly. Your balance system becomes confused without the constant reference of Earth's gravity. Research shows astronauts who complete comprehensive physical preparation experience less severe space adaptation syndrome, maintain greater strength during missions, and recover faster upon return to Earth.";return this._addMessageToConversation(s,"stella"),s}if(t.includes("next")||t.includes("after")||t.includes("future")){var a="After completing the Core & Balance Foundation mission, your next recommended training is the Endurance Boost mission. This will build on your foundational stability by developing the cardiovascular endurance needed for EVA operations and emergency procedures. All physical training missions work together to create complete astronaut-level physical preparation.";return this._addMessageToConversation(a,"stella"),a}if(t.includes("credits")||t.includes("points")||t.includes("reward")){var c="Training credits are earned by completing assessments, exercises, and full missions. For this Core & Balance mission, you'll earn 75 credits for completing each exercise session, with bonus credits for excellent form quality. These credits unlock advanced training modules and contribute to your Space Readiness certification level. Credits also reduce your Space Readiness Countdown timer.";return this._addMessageToConversation(c,"stella"),c}if(t.includes("countdown")||t.includes("timer")||t.includes("days")){var u="Your Space Readiness Countdown represents the estimated time until you've completed the essential training for space operations. Completing missions reduces this countdown, with more challenging missions providing greater reductions. The Core & Balance Foundation mission will reduce your countdown by 18 days total, with each session contributing proportionally.";return this._addMessageToConversation(u,"stella"),u}if(t.includes("exercises")||t.includes("workout")||t.includes("routine")){var l="This Core & Balance mission contains three key exercises: Space Plank, Astronaut Hollow Hold, and Microgravity Rotations. Each targets specific physiological systems needed in space. Space Plank develops the core stability needed for EVA operations. Hollow Hold trains your body positioning for launch and reentry. Rotation exercises prepare your vestibular system for microgravity orientation. Complete all exercises for comprehensive preparation.";return this._addMessageToConversation(l,"stella"),l}if(t.includes("hard")||t.includes("difficult")||t.includes("challenge")){var d="It's normal to find some of these exercises challenging. Astronaut training is designed to gradually build capabilities you don't normally need on Earth. The vestibular exercises often feel the most challenging at first because we rarely train this system specifically. If you're finding an exercise too difficult, focus on shorter durations with perfect form rather than longer durations with compromised technique.";return this._addMessageToConversation(d,"stella"),d}if(t.includes("how long")||t.includes("duration")||t.includes("time")){var h="The Core & Balance mission consists of three training sessions, each taking approximately 20-30 minutes to complete. Ideally, these sessions should be separated by 24-48 hours to allow for adaptation. Most trainees complete the full mission within 2-3 weeks, though your specific pace may vary based on your schedule and adaptation rate.";return this._addMessageToConversation(h,"stella"),h}if(t.includes("help")||t.includes("guide")||t.includes("how do i")){var p="I'm here to guide your training! To get started, complete the initial assessment by clicking the 'Take Assessment' button. After that, you'll be able to access the first training session. Follow the on-screen instructions and timer for each exercise. I'll provide real-time guidance on your form and technique. You can ask me specific questions about any exercise at any time during your training.";return this._addMessageToConversation(p,"stella"),p}if(t.includes("space")||t.includes("astronaut")||t.includes("zero g")||t.includes("microgravity")){var m="Space environments create unique challenges for the human body. In microgravity, your muscles don't work against gravity and can atrophy quickly. Your vestibular system loses its primary reference point, causing disorientation. Fluids shift upward in your body, affecting circulation. This training program specifically addresses these challenges, preparing your physiology for the demanding environment of space through targeted exercises developed from actual astronaut training protocols.";return this._addMessageToConversation(m,"stella"),m}var g="I'm your STELLA AI assistant for space training. I'm here to guide you through exercises specifically designed to prepare your body for space environments. The Core & Balance mission you're working on is foundational for all space activities, developing the stability and vestibular adaptation needed for microgravity operations. Is there something specific about your training you'd like to know more about?";return this._addMessageToConversation(g,"stella"),g}}],n&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r,s,c,u}())}}]);