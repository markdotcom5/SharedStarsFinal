/*! For license information please see 728.bundle.js.LICENSE.txt */
(self.webpackChunksteltrek_project=self.webpackChunksteltrek_project||[]).push([[728],{728:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(){"use strict";a=function(){return n};var e,n={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,a=Object.create(o.prototype),s=new P(r||[]);return i(a,"_invoke",{value:O(e,n,s)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=h;var m="suspendedStart",p="suspendedYield",v="executing",g="completed",y={};function w(){}function b(){}function E(){}var x={};d(x,c,(function(){return this}));var S=Object.getPrototypeOf,L=S&&S(S(A([])));L&&L!==r&&o.call(L,c)&&(x=L);var k=E.prototype=w.prototype=Object.create(x);function C(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,n){function r(i,a,s,c){var l=f(e[i],e,a);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==t(d)&&o.call(d,"__await")?n.resolve(d.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):n.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,c)}))}c(l.arg)}var a;i(this,"_invoke",{value:function(e,t){function o(){return new n((function(n,o){r(e,t,n,o)}))}return a=a?a.then(o,o):o()}})}function O(t,n,r){var o=m;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=N(s,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===m)throw o=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var l=f(t,n,r);if("normal"===l.type){if(o=r.done?g:p,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=g,r.method="throw",r.arg=l.arg)}}}function N(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,N(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function A(n){if(n||""===n){var r=n[c];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var i=-1,a=function t(){for(;++i<n.length;)if(o.call(n,i))return t.value=n[i],t.done=!1,t;return t.value=e,t.done=!0,t};return a.next=a}}throw new TypeError(t(n)+" is not iterable")}return b.prototype=E,i(k,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:b,configurable:!0}),b.displayName=d(E,u,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,d(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},n.awrap=function(e){return{__await:e}},C(I.prototype),d(I.prototype,l,(function(){return this})),n.AsyncIterator=I,n.async=function(e,t,r,o,i){void 0===i&&(i=Promise);var a=new I(h(e,t,r,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(k),d(k,u,"Generator"),d(k,c,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=A,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),l=o.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},n}function s(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){s(i,r,o,a,c,"next",e)}function c(e){s(i,r,o,a,c,"throw",e)}a(void 0)}))}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return(t=f(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f(r.key),r)}}function f(e){var n=function(e){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(n)?n:n+""}var m=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=u({apiUrl:"/api",useLocalStorage:!0,debugMode:!1},t),this.state={user:null,notifications:[],isOnline:navigator.onLine,pendingUploads:[],sessionData:null},this.cacheElements(),this.setupEventListeners(),this.initializeComponents(),this.checkAuth(),this.options.debugMode&&console.log("SharedStars Frontend initialized with options:",this.options)},t=[{key:"cacheElements",value:function(){this.userProfileElement=document.getElementById("user-profile"),this.loginFormElement=document.getElementById("login-form"),this.registerFormElement=document.getElementById("register-form"),this.logoutButtonElement=document.getElementById("logout-button"),this.userAvatarElement=document.getElementById("user-avatar"),this.userNameElement=document.getElementById("user-name"),this.userRankElement=document.getElementById("user-rank"),this.userCreditsElement=document.getElementById("user-credits"),this.notificationElement=document.getElementById("notification-area"),this.notificationCountElement=document.getElementById("notification-count"),this.moduleCardsElements=document.querySelectorAll(".module-card"),this.startModuleButtons=document.querySelectorAll(".start-module"),this.progressChartElement=document.getElementById("progress-chart"),this.streakCountElement=document.getElementById("streak-count"),this.nextMissionElement=document.getElementById("next-mission"),this.leaderboardElement=document.getElementById("leaderboard"),this.forms=document.querySelectorAll("form[data-api-submit]"),this.searchInput=document.getElementById("search-input"),this.searchResults=document.getElementById("search-results"),this.countdownElements=document.querySelectorAll("[data-countdown]"),this.creditsDisplayElements=document.querySelectorAll(".credits-display")}},{key:"setupEventListeners",value:function(){var e=this;this.loginFormElement&&this.loginFormElement.addEventListener("submit",(function(t){t.preventDefault(),e.handleLogin(t.target)})),this.registerFormElement&&this.registerFormElement.addEventListener("submit",(function(t){t.preventDefault(),e.handleRegistration(t.target)})),this.logoutButtonElement&&this.logoutButtonElement.addEventListener("click",(function(){e.handleLogout()})),this.moduleCardsElements.forEach((function(t){t.addEventListener("click",(function(){var n=t.dataset.moduleId;n&&e.showModuleDetails(n)}))})),this.startModuleButtons.forEach((function(t){t.addEventListener("click",(function(n){n.stopPropagation();var r=t.dataset.moduleId;r&&e.startModule(r)}))})),this.forms.forEach((function(t){t.addEventListener("submit",(function(n){n.preventDefault(),e.handleFormSubmit(t)}))})),this.searchInput&&this.searchInput.addEventListener("input",(function(){e.debounce(e.performSearch.bind(e),300)()})),window.addEventListener("online",(function(){e.handleOnlineStatus(!0)})),window.addEventListener("offline",(function(){e.handleOnlineStatus(!1)})),document.addEventListener("api-request-start",(function(){e.showLoading(!0)})),document.addEventListener("api-request-end",(function(){e.showLoading(!1)})),document.addEventListener("stella-guidance",(function(t){e.options.debugMode&&console.log("STELLA Guidance received:",t.detail)})),document.addEventListener("stella-response",(function(t){e.options.debugMode&&console.log("STELLA Response received:",t.detail)})),window.addEventListener("beforeunload",(function(t){if(e.state.pendingUploads.length>0||e.state.sessionData&&e.state.sessionData.active){var n="You have unsaved changes or an active session. Are you sure you want to leave?";return t.returnValue=n,n}}))}},{key:"initializeComponents",value:function(){this.initializeTooltips(),this.initializeModals(),this.initializeCountdowns(),window.Chart&&this.progressChartElement&&this.initializeCharts(),this.initializeClipboard(),this.initializeLazyLoading(),this.initializeSmoothScroll(),this.options.useLocalStorage&&this.setupPeriodicSync()}},{key:"initializeTooltips",value:function(){document.querySelectorAll("[data-tooltip]").forEach((function(e){e.addEventListener("mouseenter",(function(t){var n=e.dataset.tooltip;if(n){var r=document.createElement("div");r.className="tooltip absolute z-50 bg-gray-900 text-white text-xs px-2 py-1 rounded pointer-events-none transform -translate-y-full -translate-x-1/2 left-1/2 -mt-1",r.textContent=n,e.style.position="relative",e.appendChild(r),e.addEventListener("mouseleave",(function(){r.parentNode===e&&e.removeChild(r)}),{once:!0})}}))}))}},{key:"initializeModals",value:function(){var e=document.querySelectorAll("[data-modal]"),t=document.querySelectorAll(".modal");e.forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.modal,n=document.getElementById(t);n&&n.classList.remove("hidden")}))})),t.forEach((function(e){e.querySelectorAll(".close-modal").forEach((function(t){t.addEventListener("click",(function(){e.classList.add("hidden")}))})),e.addEventListener("click",(function(t){t.target===e&&e.classList.add("hidden")}))}))}},{key:"initializeCountdowns",value:function(){this.countdownElements.forEach((function(e){var t=new Date(e.dataset.countdown).getTime(),n=setInterval((function(){var r=(new Date).getTime(),o=t-r;if(o<0)return clearInterval(n),void(e.textContent=e.dataset.countdownExpired||"EXPIRED");var i=Math.floor(o/864e5),a=Math.floor(o%864e5/36e5),s=Math.floor(o%36e5/6e4),c=Math.floor(o%6e4/1e3);e.textContent="".concat(i,"d ").concat(a,"h ").concat(s,"m ").concat(c,"s")}),1e3)}))}},{key:"initializeCharts",value:function(){if(this.progressChartElement&&window.Chart){var e=this.progressChartElement.getContext("2d");this.progressChart=new Chart(e,{type:"line",data:{labels:["Jan","Feb","Mar","Apr","May","Jun"],datasets:[{label:"Progress",backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1,data:[10,25,40,30,70,85]}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100}}}})}}},{key:"initializeClipboard",value:function(){document.querySelectorAll("[data-clipboard]").forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.clipboard;t&&navigator.clipboard.writeText(t).then((function(){var t=e.textContent;e.textContent="Copied!",setTimeout((function(){e.textContent=t}),2e3)})).catch((function(e){console.error("Failed to copy text: ",e)}))}))}))}},{key:"initializeLazyLoading",value:function(){if("IntersectionObserver"in window){var e=document.querySelectorAll("img[data-src]"),t=new IntersectionObserver((function(e,n){e.forEach((function(e){if(e.isIntersecting){var n=e.target;n.src=n.dataset.src,n.removeAttribute("data-src"),t.unobserve(n)}}))}));e.forEach((function(e){t.observe(e)}))}else document.querySelectorAll("img[data-src]").forEach((function(e){e.src=e.dataset.src,e.removeAttribute("data-src")}))}},{key:"initializeSmoothScroll",value:function(){document.querySelectorAll('a[href^="#"]:not([href="#"])').forEach((function(e){e.addEventListener("click",(function(e){e.preventDefault();var t=this.getAttribute("href"),n=document.querySelector(t);n&&(n.scrollIntoView({behavior:"smooth",block:"start"}),history.pushState(null,null,t))}))}))}},{key:"setupPeriodicSync",value:function(){var e=this;setInterval((function(){navigator.onLine&&e.state.pendingUploads.length>0&&e.syncOfflineData()}),3e4),window.addEventListener("online",(function(){e.syncOfflineData()}))}},{key:"checkAuth",value:(g=c(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.options.useLocalStorage&&(t=localStorage.getItem("sharedStars_user"))&&(this.state.user=JSON.parse(t),this.updateUserUI()),!navigator.onLine){e.next=7;break}return e.next=5,this.apiRequest("/auth/status",{method:"GET"});case 5:(n=e.sent).authenticated?(this.state.user=n.user,this.options.useLocalStorage&&localStorage.setItem("sharedStars_user",JSON.stringify(n.user)),this.updateUserUI()):(this.state.user=null,this.options.useLocalStorage&&localStorage.removeItem("sharedStars_user"),this.updateUserUI());case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error checking authentication status:",e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return g.apply(this,arguments)})},{key:"handleLogin",value:(v=c(a().mark((function e(t){var n,r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new FormData(t),r={email:n.get("email"),password:n.get("password"),rememberMe:"on"===n.get("remember-me")},e.next=5,this.apiRequest("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 5:(o=e.sent).success?(this.state.user=o.user,r.rememberMe&&this.options.useLocalStorage&&localStorage.setItem("sharedStars_user",JSON.stringify(o.user)),this.updateUserUI(),this.showNotification("Login successful!","success"),window.location.href=o.redirectUrl||"/dashboard"):this.showNotification(o.message||"Login failed. Please try again.","error"),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Login error:",e.t0),this.showNotification("An error occurred during login. Please try again.","error");case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return v.apply(this,arguments)})},{key:"handleRegistration",value:(p=c(a().mark((function e(t){var n,r,o,i,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=new FormData(t),r=n.get("password"),o=n.get("confirm-password"),r===o){e.next=7;break}return this.showNotification("Passwords do not match.","error"),e.abrupt("return");case 7:return i={name:n.get("name"),email:n.get("email"),password:r},e.next=10,this.apiRequest("/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});case 10:(s=e.sent).success?(this.showNotification("Registration successful! Please check your email for verification.","success"),setTimeout((function(){window.location.href="/login"}),2e3)):this.showNotification(s.message||"Registration failed.","error"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Registration error:",e.t0),this.showNotification("An error occurred during registration. Please try again.","error");case 18:case"end":return e.stop()}}),e,this,[[0,14]])}))),function(e){return p.apply(this,arguments)})},{key:"handleLogout",value:(m=c(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.apiRequest("/auth/logout",{method:"POST"});case 3:e.sent,this.state.user=null,this.options.useLocalStorage&&localStorage.removeItem("sharedStars_user"),this.updateUserUI(),this.showNotification("Logout successful!","success"),setTimeout((function(){window.location.href="/"}),1e3),e.next=18;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Logout error:",e.t0),this.state.user=null,this.options.useLocalStorage&&localStorage.removeItem("sharedStars_user"),this.updateUserUI(),window.location.href="/";case 18:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(){return m.apply(this,arguments)})},{key:"updateUserUI",value:function(){var e,t,n,r,o=this;this.state.user?(document.body.classList.add("user-logged-in"),document.body.classList.remove("user-logged-out"),this.userNameElement&&(this.userNameElement.textContent=this.state.user.name),this.userAvatarElement&&(this.userAvatarElement.src=this.state.user.avatar||"/images/default-avatar.png",this.userAvatarElement.alt=this.state.user.name),this.userRankElement&&(this.userRankElement.textContent=this.state.user.rank||"Cadet"),this.userCreditsElement&&(this.userCreditsElement.textContent=this.state.user.credits||0),this.creditsDisplayElements.forEach((function(e){e.textContent=o.state.user.credits||0})),this.userProfileElement&&this.userProfileElement.classList.remove("hidden"),this.loginFormElement&&(null===(e=this.loginFormElement.closest(".login-container"))||void 0===e||e.classList.add("hidden")),this.registerFormElement&&(null===(t=this.registerFormElement.closest(".register-container"))||void 0===t||t.classList.add("hidden"))):(document.body.classList.add("user-logged-out"),document.body.classList.remove("user-logged-in"),this.userProfileElement&&this.userProfileElement.classList.add("hidden"),window.location.pathname.includes("/login")&&this.loginFormElement&&(null===(n=this.loginFormElement.closest(".login-container"))||void 0===n||n.classList.remove("hidden")),window.location.pathname.includes("/register")&&this.registerFormElement&&(null===(r=this.registerFormElement.closest(".register-container"))||void 0===r||r.classList.remove("hidden")))}},{key:"showModuleDetails",value:(f=c(a().mark((function e(t){var n,r,o,i,s,c,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.apiRequest("/modules/".concat(t),{method:"GET"});case 3:(n=e.sent).success?(r=n.module,(o=document.getElementById("module-details-modal"))&&((i=o.querySelector(".modal-title"))&&(i.textContent=r.name),(s=o.querySelector(".modal-description"))&&(s.textContent=r.description),(c=o.querySelector(".modal-image"))&&(c.src=r.image||"/images/default-module.jpg",c.alt=r.name),(l=o.querySelector(".start-module-button"))&&(l.dataset.moduleId=t),o.classList.remove("hidden"))):this.showNotification(n.message||"Failed to load module details.","error"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error loading module details:",e.t0),this.showNotification("An error occurred while loading module details.","error");case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return f.apply(this,arguments)})},{key:"startModule",value:(d=c(a().mark((function e(t){var n,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.state.user){e.next=5;break}return this.showNotification("Please log in to start training.","warning"),window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname),e.abrupt("return");case 5:return e.next=7,this.apiRequest("/modules/".concat(t,"/start"),{method:"POST"});case 7:(n=e.sent).success?(this.state.sessionData=n.session,window.location.href="/training/".concat(t)):this.showNotification(n.message||"Failed to start module.","error"),e.next=15;break;case 11:if(e.prev=11,e.t0=e.catch(0),console.error("Error starting module:",e.t0),!navigator.onLine&&this.options.useLocalStorage)try{JSON.parse(localStorage.getItem("sharedStars_modules")||"{}")[t]?(r={id:"offline-".concat(Date.now()),moduleId:t,startTime:(new Date).toISOString(),offlineMode:!0},localStorage.setItem("sharedStars_currentSession",JSON.stringify(r)),window.location.href="/training/".concat(t,"?offline=true")):this.showNotification("Module data not available offline.","error")}catch(e){console.error("Error starting offline module:",e),this.showNotification("Failed to start module in offline mode.","error")}else this.showNotification("An error occurred while starting the module.","error");case 15:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e){return d.apply(this,arguments)})},{key:"handleFormSubmit",value:(l=c(a().mark((function e(t){var n,r,o,i,s,c,l,u,d,h,f,m,p,v;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=new FormData(t),r=t.dataset.apiEndpoint,o=t.dataset.apiMethod||"POST",r){e.next=7;break}return console.error("Form is missing data-api-endpoint attribute"),e.abrupt("return");case 7:return"json"===(s=t.dataset.apiContentType||"json")?(c={},n.forEach((function(e,t){c[t]=e})),i=JSON.stringify(c)):i=n,(l=t.querySelector('[type="submit"]'))&&(l.textContent,l.disabled=!0,l.textContent="Processing...",l.querySelector(".loading-spinner")&&l.querySelector(".loading-spinner").classList.remove("hidden")),e.next=13,this.apiRequest(r,{method:o,headers:"json"===s?{"Content-Type":"application/json"}:void 0,body:i});case 13:u=e.sent,l&&(l.disabled=!1,l.textContent=originalText,l.querySelector(".loading-spinner")&&l.querySelector(".loading-spinner").classList.add("hidden")),u.success?(this.showNotification(u.message||"Success!","success"),"true"===t.dataset.apiClearOnSuccess&&t.reset(),u.redirectUrl&&(window.location.href=u.redirectUrl),t.dataset.apiCallback&&"function"==typeof(d=window[t.dataset.apiCallback])&&d(u),t.dispatchEvent(new CustomEvent("api-form-success",{detail:u}))):(this.showNotification(u.message||"An error occurred.","error"),u.errors&&Object.keys(u.errors).length>0&&(h=Object.keys(u.errors)[0],(f=t.querySelector('[name="'.concat(h,'"]')))&&(f.focus(),(m=document.createElement("div")).className="text-red-500 text-xs mt-1",m.textContent=u.errors[h],(p=f.parentNode.querySelector(".text-red-500"))&&p.remove(),f.parentNode.appendChild(m))),t.dispatchEvent(new CustomEvent("api-form-error",{detail:u}))),e.next=25;break;case 18:e.prev=18,e.t0=e.catch(0),console.error("Form submission error:",e.t0),this.showNotification("An error occurred while processing your request.","error"),(v=t.querySelector('[type="submit"]'))&&(v.disabled=!1,v.textContent="Submit",v.querySelector(".loading-spinner")&&v.querySelector(".loading-spinner").classList.add("hidden")),!navigator.onLine&&this.options.useLocalStorage&&this.storePendingFormSubmission(t);case 25:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(e){return l.apply(this,arguments)})},{key:"storePendingFormSubmission",value:function(e){try{var t=new FormData(e),n=e.dataset.apiEndpoint,r=e.dataset.apiMethod||"POST",o=e.dataset.apiContentType||"json",i={};t.forEach((function(e,t){i[t]=e})),this.state.pendingUploads.push({id:"form-".concat(Date.now()),endpoint:n,method:r,contentType:o,data:i,timestamp:(new Date).toISOString()}),localStorage.setItem("sharedStars_pendingUploads",JSON.stringify(this.state.pendingUploads)),this.showNotification("Form data saved. Will be submitted when you're back online.","info")}catch(e){console.error("Error storing pending form submission:",e)}}},{key:"syncOfflineData",value:(s=c(a().mark((function e(){var t,o,i,s,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.onLine&&0!==this.state.pendingUploads.length){e.next=2;break}return e.abrupt("return");case 2:t=r(this.state.pendingUploads),o=[],i=n(t),e.prev=5,i.s();case 7:if((s=i.n()).done){e.next=21;break}return c=s.value,e.prev=9,e.next=12,this.apiRequest(c.endpoint,{method:c.method,headers:"json"===c.contentType?{"Content-Type":"application/json"}:void 0,body:"json"===c.contentType?JSON.stringify(c.data):new FormData(c.data)});case 12:e.sent.success&&o.push(c.id),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.error("Error syncing upload ".concat(c.id,":"),e.t0);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(5),i.e(e.t1);case 26:return e.prev=26,i.f(),e.finish(26);case 29:o.length>0&&(this.state.pendingUploads=this.state.pendingUploads.filter((function(e){return!o.includes(e.id)})),localStorage.setItem("sharedStars_pendingUploads",JSON.stringify(this.state.pendingUploads)),this.showNotification("Synced ".concat(o.length," pending uploads."),"success"));case 30:case"end":return e.stop()}}),e,this,[[5,23,26,29],[9,16]])}))),function(){return s.apply(this,arguments)})},{key:"performSearch",value:(i=c(a().mark((function e(){var t,n,r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this.searchInput.value.trim())&&!(t.length<2)){e.next=4;break}return this.searchResults&&(this.searchResults.innerHTML="",this.searchResults.classList.add("hidden")),e.abrupt("return");case 4:return e.prev=4,e.next=7,this.apiRequest("/search?q=".concat(encodeURIComponent(t)),{method:"GET"});case 7:if(!(n=e.sent).success||!this.searchResults){e.next=15;break}if(this.searchResults.innerHTML="",this.searchResults.classList.remove("hidden"),0!==n.results.length){e.next=14;break}return this.searchResults.innerHTML='\n            <div class="p-4 text-center text-gray-400">\n              No results found for "'.concat(t,'"\n            </div>\n          '),e.abrupt("return");case 14:n.results.forEach((function(e){var t=document.createElement("div");t.className="p-3 hover:bg-gray-800 cursor-pointer flex items-center",t.innerHTML='\n            <div class="mr-3">\n              <img src="'.concat(e.image||"/images/default.png",'" alt="').concat(e.title,'" class="w-10 h-10 rounded">\n            </div>\n            <div>\n              <div class="font-medium text-white">').concat(e.title,'</div>\n              <div class="text-gray-400 text-sm">').concat(e.type,"</div>\n            </div>\n          "),t.addEventListener("click",(function(){window.location.href=e.url})),r.searchResults.appendChild(t)}));case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),console.error("Search error:",e.t0),this.searchResults&&(this.searchResults.innerHTML='\n          <div class="p-4 text-center text-red-400">\n            Error performing search. Please try again.\n          </div>\n        ');case 21:case"end":return e.stop()}}),e,this,[[4,17]])}))),function(){return i.apply(this,arguments)})},{key:"showLoading",value:function(e){var t=document.getElementById("loading-indicator");t&&(e?t.classList.remove("hidden"):t.classList.add("hidden"))}},{key:"handleOnlineStatus",value:function(e){if(this.state.isOnline=e,e){var t=document.getElementById("offline-banner");t&&t.classList.add("hidden"),this.syncOfflineData(),this.showNotification("You are back online!","success")}else{var n=document.getElementById("offline-banner");if(n)n.classList.remove("hidden");else{var r=document.createElement("div");r.id="offline-banner",r.className="fixed top-0 left-0 right-0 bg-yellow-900 text-yellow-100 py-2 px-4 text-center z-50",r.innerHTML='\n          <div class="flex items-center justify-center">\n            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">\n              <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />\n            </svg>\n            <span>You are currently offline. Some features may be limited.</span>\n          </div>\n        ',document.body.prepend(r)}this.showNotification("You are offline. Limited functionality available.","warning")}}},{key:"showNotification",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;this.notificationElement||(this.notificationElement=document.createElement("div"),this.notificationElement.className="fixed bottom-4 right-4 z-50 flex flex-col-reverse gap-2",document.body.appendChild(this.notificationElement));var o=document.createElement("div");o.className="transform transition-all duration-300 translate-x-full max-w-sm rounded-lg shadow-lg p-4 ".concat("success"===n?"bg-green-900/80 border border-green-500/30 text-green-100":"warning"===n?"bg-yellow-900/80 border border-yellow-500/30 text-yellow-100":"error"===n?"bg-red-900/80 border border-red-500/30 text-red-100":"bg-blue-900/80 border border-blue-500/30 text-blue-100"),o.innerHTML='\n      <div class="flex items-start">\n        <div class="flex-shrink-0 mr-3">\n          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 '.concat("success"===n?"text-green-400":"warning"===n?"text-yellow-400":"error"===n?"text-red-400":"text-blue-400",'" viewBox="0 0 20 20" fill="currentColor">\n            ').concat("success"===n?'<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />':"warning"===n?'<path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />':"error"===n?'<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />':'<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />',"\n          </svg>\n        </div>\n        <div>\n          <p>").concat(e,'</p>\n        </div>\n        <button class="ml-auto -mr-2 text-gray-400 hover:text-white">\n          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">\n            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />\n          </svg>\n        </button>\n      </div>\n    '),this.notificationElement.appendChild(o),o.querySelector("button").addEventListener("click",(function(){t.removeNotification(o)}));var i=setTimeout((function(){t.removeNotification(o)}),r);return this.state.notifications.push({element:o,timeout:i}),setTimeout((function(){o.classList.remove("translate-x-full")}),10),o}},{key:"removeNotification",value:function(e){var t=this;e.classList.add("translate-x-full");var n=this.state.notifications.findIndex((function(t){return t.element===e}));-1!==n&&(clearTimeout(this.state.notifications[n].timeout),this.state.notifications.splice(n,1)),setTimeout((function(){e.parentNode===t.notificationElement&&t.notificationElement.removeChild(e)}),300)}},{key:"apiRequest",value:(o=c(a().mark((function e(t){var n,r,o,i,s,c,l=arguments;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:{},document.dispatchEvent(new CustomEvent("api-request-start")),e.prev=2,r=t.startsWith("http")?t:this.options.apiUrl+t,o=n.headers||{},this.state.user&&this.state.user.token&&(o.Authorization="Bearer ".concat(this.state.user.token)),e.next=8,fetch(r,u(u({},n),{},{headers:o}));case 8:if(i=e.sent,!(c=i.headers.get("Content-Type"))||!c.includes("application/json")){e.next=16;break}return e.next=13,i.json();case 13:s=e.sent,e.next=19;break;case 16:return e.next=18,i.text();case 18:s=e.sent;case 19:return s.status=i.status,s.ok=i.ok,s.success||(s.success=i.ok),this.options.debugMode&&console.log("API ".concat(n.method||"GET"," ").concat(t,":"),s),document.dispatchEvent(new CustomEvent("api-request-end",{detail:s})),e.abrupt("return",s);case 27:throw e.prev=27,e.t0=e.catch(2),console.error("API Error (".concat(t,"):"),e.t0),document.dispatchEvent(new CustomEvent("api-request-end",{detail:{error:e.t0}})),e.t0;case 32:case"end":return e.stop()}}),e,this,[[2,27]])}))),function(e){return o.apply(this,arguments)})},{key:"debounce",value:function(e,t){var n;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=this;clearTimeout(n),n=setTimeout((function(){return e.apply(a,o)}),t)}}}],t&&h(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,o,i,s,l,d,f,m,p,v,g}();document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("frontend-config"),t={};if(e)try{t=JSON.parse(e.textContent)}catch(e){console.warn("Error parsing frontend config:",e)}window.sharedStars=new m(t),console.log("SharedStars Frontend initialized")})),e.exports?e.exports=m:window.SharedStarsFrontend=m}}]);