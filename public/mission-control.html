<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SharedStars Mission Control</title>

  <!-- Security Headers -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self'; 
    script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net;
    style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com https://cdnjs.cloudflare.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data:;
    connect-src 'self' https://api.sharedstars.com;
  ">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/ai-assistant.css">
  <link rel="stylesheet" href="/css/countdown.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <style>
    /* Custom styles to match design */
    body {
      background-color: #000;
      color: white;
      font-family: 'Inter', sans-serif;
    }
    
    .command-center-bg {
      background: radial-gradient(circle at center, #0a1128 0%, #030b1a 100%);
      position: relative;
    }
    
    .mission-control-card {
      background-color: rgba(17, 24, 39, 0.8);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 0.75rem;
      transition: all 0.3s ease;
    }
    
    .mission-control-card:hover {
      border-color: rgba(59, 130, 246, 0.5);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.2);
    }
    
    .orbital-ring {
      position: absolute;
      border: 1px solid rgba(59, 130, 246, 0.3);
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    .stella-bubble {
      background-color: rgba(30, 64, 175, 0.2);
      border: 1px solid rgba(59, 130, 246, 0.3);
      border-radius: 1rem;
      padding: 1.25rem;
      position: relative;
    }
    
    .stella-bubble:before {
      content: '';
      position: absolute;
      left: -10px;
      top: 20px;
      border-top: 10px solid transparent;
      border-bottom: 10px solid transparent;
      border-right: 10px solid rgba(59, 130, 246, 0.3);
    }
    
    .stars-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url('/images/stars-bg.png');
      background-size: cover;
      opacity: 0.3;
      pointer-events: none;
      z-index: 0;
    }
    
    .radar-grid {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      height: 80%;
      border-radius: 50%;
      border: 1px solid rgba(59, 130, 246, 0.1);
      z-index: 0;
    }
    
    .radar-grid:before, .radar-grid:after {
      content: '';
      position: absolute;
      background-color: rgba(59, 130, 246, 0.1);
    }
    
    .radar-grid:before {
      left: 0;
      top: 50%;
      width: 100%;
      height: 1px;
    }
    
    .radar-grid:after {
      top: 0;
      left: 50%;
      width: 1px;
      height: 100%;
    }
    
    .inner-radar-circle {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 40%;
      height: 40%;
      border-radius: 50%;
      border: 1px solid rgba(59, 130, 246, 0.2);
    }
    
    .progress-bar {
      height: 0.5rem;
      background-color: rgba(75, 85, 99, 0.5);
      border-radius: 9999px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background-color: #3B82F6;
      border-radius: 9999px;
    }
    
    .assessment-card {
      background: linear-gradient(to bottom, rgba(21, 27, 49, 0.8), rgba(13, 18, 36, 0.8));
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 0.75rem;
      transition: all 0.3s ease;
    }
    
    .assessment-card:hover {
      transform: translateY(-5px);
      border-color: rgba(59, 130, 246, 0.5);
      box-shadow: 0 8px 20px rgba(59, 130, 246, 0.2);
    }
    
    .assessment-icon {
      background-color: rgba(30, 64, 175, 0.2);
      border-radius: 50%;
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #60A5FA;
    }
    .mission-control-container {
    display: flex;
    height: 100vh;
}

.sidebar {
    width: 300px;
    background: #1c2836;
    color: white;
    padding: 20px;
    overflow-y: auto;
}

.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.countdown-section {
    background: rgba(0, 0, 0, 0.2);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
}

#mission-countdown {
    font-size: 32px;
    font-weight: bold;
    color: #4caf50;
}

.countdown-label {
    font-size: 14px;
    opacity: 0.7;
}

.stella-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #f5f5f5;
    border-left: 1px solid #ddd;
}

.stella-header {
    padding: 15px;
    background: #2c3e50;
    color: white;
}

.stella-conversation {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

.message {
    margin-bottom: 15px;
    max-width: 80%;
}

.message.user {
    align-self: flex-end;
    background: #dcf8c6;
    border-radius: 15px 15px 0 15px;
    padding: 10px 15px;
}

.message.stella {
    align-self: flex-start;
    background: white;
    border-radius: 15px 15px 15px 0;
    padding: 10px 15px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.message.system {
    align-self: center;
    background: #f0f0f0;
    border-radius: 10px;
    padding: 10px 15px;
    font-style: italic;
    max-width: 90%;
}

.message-feedback {
    display: flex;
    justify-content: flex-end;
    margin-top: 5px;
}

.message-feedback button {
    background: none;
    border: none;
    color: #888;
    cursor: pointer;
    margin-left: 10px;
}

.message-feedback button:hover {
    color: #2c3e50;
}

.feedback-submitted {
    font-size: 12px;
    color: #4caf50;
}

.stella-input {
    display: flex;
    padding: 15px;
    background: white;
    border-top: 1px solid #ddd;
}

.stella-input input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 20px;
    margin-right: 10px;
}

.stella-input button {
    background: #2c3e50;
    color: white;
    border: none;
    border-radius: 20px;
    padding: 10px 20px;
    cursor: pointer;
}

.action-items {
    margin-top: 10px;
    background: rgba(76, 175, 80, 0.1);
    padding: 10px;
    border-radius: 5px;
    border-left: 3px solid #4caf50;
}

.action-items h4 {
    margin: 0 0 5px 0;
    color: #2c3e50;
}

.action-items ul {
    margin: 0;
    padding-left: 20px;
}

.typing-indicator {
    display: flex;
    align-items: center;
    padding: 15px;
}

.typing-indicator .dot {
    width: 8px;
    height: 8px;
    background: #888;
    border-radius: 50%;
    margin: 0 2px;
    animation: typing 1s infinite ease-in-out;
}

.typing-indicator .dot:nth-child(1) {
    animation-delay: 0s;
}

.typing-indicator .dot:nth-child(2) {
    animation-delay: 0.2s;
}

.typing-indicator .dot:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typing {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-5px);
    }
}
.stella-conversation {
  color: #ffffff; /* or any other color that contrasts with your background */
}

/* Fix text contrast issues */
.message {
  color: #0a0a14 !important; /* Dark text color */
  background-color: rgba(255, 255, 255, 0.9) !important; /* White background with opacity */
  border: 1px solid #1e3f5a !important;
  padding: 8px 12px !important;
  border-radius: 8px !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
  max-width: 80% !important;
  margin-bottom: 10px !important;
}

/* User messages should be right-aligned with different styling */
.message.user {
  background-color: rgba(30, 87, 153, 0.1) !important;
  border-color: #1e57a9 !important;
  margin-left: auto !important;
  margin-right: 0 !important;
}

/* STELLA messages should be left-aligned */
.message.stella {
  background-color: rgba(255, 255, 255, 0.9) !important;
  margin-right: auto !important;
  margin-left: 0 !important;
}

.user-message, .stella-message {
  color: #ffffff;
}

/* Make sure input text is visible too */
#stella-question {
  color: #ffffff;
  background-color: rgba(0, 0, 0, 0.3);
}
.recommendations-panel {
    background: rgba(0, 0, 0, 0.2);
    padding: 15px;
    border-radius: 10px;
}

.recommendation {
    background: rgba(255, 255, 255, 0.1);
    padding: 12px;
    margin-bottom: 10px;
    border-radius: 8px;
    border-left: 3px solid #3498db;
}

.recommendation-title {
    font-weight: bold;
    margin-bottom: 5px;
}

.recommendation-description {
    font-size: 14px;
    margin-bottom: 10px;
    opacity: 0.8;
}

.recommendation-action {
    display: inline-block;
    background: #3498db;
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    text-decoration: none;
    font-size: 12px;
}

.countdown-impact {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #2c3e50;
    color: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    animation: slide-in 0.5s ease-out;
    z-index: 1000;
}

.impact-message {
    display: flex;
    align-items: center;
}

.impact-message i {
    margin-right: 10px;
    color: #4caf50;
}

.impact-value {
    margin-left: 10px;
    font-weight: bold;
    color: #4caf50;
}

.fade-out {
    animation: fade-out 0.5s ease-in;
    opacity: 0;
}

@keyframes slide-in {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes fade-out {
    from {
        opacity: 1;
    }
    to {
        opacity: 0;
    }
}
    /* Add to your existing CSS */
.personality-slider {
  -webkit-appearance: none;
  appearance: none;
  height: 8px;
  background: #1e293b;
  border-radius: 4px;
  outline: none;
}

.personality-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: #3b82f6;
  cursor: pointer;
  transition: background 0.15s ease;
}

.personality-slider::-webkit-slider-thumb:hover {
  background: #60a5fa;
}

.personality-slider::-moz-range-thumb {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: #3b82f6;
  cursor: pointer;
  transition: background 0.15s ease;
  border: none;
}

.personality-slider::-moz-range-thumb:hover {
  background: #60a5fa;
}

.personality-slider-container {
  margin-bottom: 1rem;
}

.personality-preset.active {
  background-color: rgba(59, 130, 246, 0.5);
}
    .countdown-box {
      background-color: rgba(17, 24, 39, 0.7);
      border: 1px solid rgba(59, 130, 246, 0.2);
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
    }
    
    .countdown-value {
      font-size: 2rem;
      font-weight: 700;
      color: white;
    }
    
    .countdown-label {
      font-size: 0.875rem;
      color: #9CA3AF;
    }
  </style>
</head>

<body class="text-white">
  <!-- STELLA AI Integration Setup -->
  <div data-stella-auto-init="true" data-stella-debug="true" data-stella-user-id="anonymous"></div>
  
  <!-- Header -->
  <header class="fixed top-0 left-0 w-full bg-black bg-opacity-80 backdrop-blur-md z-50 shadow-lg">
    <div class="container mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <a href="/" class="flex items-center">
          <img src="/images/SSLOGO.png" alt="SharedStars Logo" class="h-10">
        </a>
        
        <nav class="hidden md:flex space-x-8">
          <a href="/" class="text-gray-300 hover:text-white transition-colors">Home</a>
          <a href="/academy.html" class="text-gray-300 hover:text-white transition-colors">Academy</a>
          <a href="/about.html" class="text-gray-300 hover:text-white transition-colors">About</a>
          <a href="/leaderboard.html" class="text-gray-300 hover:text-white transition-colors">Leaderboard</a>
          <a href="/subscribe.html" class="text-gray-300 hover:text-white transition-colors">Subscribe</a>
        </nav>
        <div class="flex items-center space-x-4">
          <div class="relative">
            <button id="language-selector" class="flex items-center text-sm text-gray-300 hover:text-white">
              <span class="mr-1">ðŸ‡ºðŸ‡¸</span>
              <span class="hidden md:inline-block">English</span>
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <!-- Language dropdown goes here -->
          </div>
          
          <a href="/get-started" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full text-sm font-medium transition-colors">
            Get Started
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content - Mission Control Dashboard -->
  <main class="pt-20 min-h-screen command-center-bg">
    <!-- Visual elements for command center look -->
    <div class="stars-overlay"></div>
    <div class="radar-grid"></div>
    <div class="inner-radar-circle"></div>
    <div class="orbital-ring" style="width: 60%; height: 30%;"></div>
    <div class="orbital-ring" style="width: 70%; height: 35%;"></div>
    <div class="orbital-ring" style="width: 80%; height: 40%;"></div>
    
    <div class="container mx-auto px-4 py-8 relative z-10">
      <!-- Welcome Header -->
      <div class="flex items-center justify-between mb-8">
        <h1 class="text-3xl font-bold text-blue-400">SharedStars Command Center</h1>
        <div class="flex items-center space-x-2">
          <div class="bg-gray-800 bg-opacity-50 px-3 py-1 rounded-full text-sm">
            Trainee ID: #ST-28456
          </div>
          <div class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center font-semibold">
            JD
          </div>
        </div>
      </div>
      
      <!-- Main Grid Layout -->
      <div class="grid grid-cols-12 gap-6">
<!-- STELLA AI Assistant - Main Chat Interface -->
<div class="col-span-12 lg:col-span-7 mb-6">
  <div class="mission-control-card p-6 h-full relative overflow-hidden">
    <div class="flex items-center mb-6">
      <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
        </svg>
      </div>
      <h2 class="text-2xl font-bold text-blue-400">STELLA AI Assistant</h2>
    </div>
    
    <!-- Conversation Container -->
    <div class="stella-conversation" style="color: #ffffff;">      <div class="message system">
        <div class="message-content">
          Welcome to STELLA, your Space Training and Education Learning Liaison Assistant. How can I help with your space training today?
        </div>
      </div>
    </div>
    
    <!-- User Input Field -->
    <div class="flex mb-4">
      <input 
        id="stella-question" 
        type="text" 
        placeholder="Ask STELLA a question..." 
        class="bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 flex-grow mr-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
      <button 
        id="send-to-stella" 
        class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-medium transition-colors">
        Ask
      </button>
    </div>
    
    <!-- Quick Action Buttons -->
    <div class="flex flex-wrap gap-2 mb-6">
      <button class="bg-blue-900 bg-opacity-30 border border-blue-800 text-blue-300 px-3 py-1 rounded-full text-sm hover:bg-opacity-50 transition-colors">
        Start Assessment
      </button>
      <button class="bg-blue-900 bg-opacity-30 border border-blue-800 text-blue-300 px-3 py-1 rounded-full text-sm hover:bg-opacity-50 transition-colors">
        Show My Progress
      </button>
      <button class="bg-blue-900 bg-opacity-30 border border-blue-800 text-blue-300 px-3 py-1 rounded-full text-sm hover:bg-opacity-50 transition-colors">
        Today's Training
      </button>
    </div>
    
    <!-- STELLA Personality Lab -->
    <div class="border-t border-blue-800 pt-4">
      <h3 class="text-lg font-semibold text-blue-300 mb-3">STELLA Personality Lab</h3>
      <p class="text-sm text-gray-400 mb-4">Customize how STELLA interacts with you by adjusting these personality traits:</p>
      
      <!-- Personality Sliders -->
      <div class="space-y-4">
        <!-- Honesty Level -->
        <div class="personality-slider-container">
          <div class="flex justify-between mb-1">
            <label for="honesty-slider" class="text-sm">Honesty Level</label>
            <span class="text-sm text-blue-300" id="honesty-value">70%</span>
          </div>
          <div class="flex items-center">
            <span class="text-xs text-gray-500 mr-2">Tactful</span>
            <input type="range" id="honesty-slider" class="personality-slider flex-grow" 
                  data-trait="honesty" min="0" max="100" value="70">
            <span class="text-xs text-gray-500 ml-2">Direct</span>
          </div>
        </div>
        
        <!-- Humor Level -->
        <div class="personality-slider-container">
          <div class="flex justify-between mb-1">
            <label for="humor-slider" class="text-sm">Humor Level</label>
            <span class="text-sm text-blue-300" id="humor-value">50%</span>
          </div>
          <div class="flex items-center">
            <span class="text-xs text-gray-500 mr-2">Serious</span>
            <input type="range" id="humor-slider" class="personality-slider flex-grow" 
                  data-trait="humor" min="0" max="100" value="50">
            <span class="text-xs text-gray-500 ml-2">Playful</span>
          </div>
        </div>
        
        <!-- Formality Level -->
        <div class="personality-slider-container">
          <div class="flex justify-between mb-1">
            <label for="formality-slider" class="text-sm">Formality</label>
            <span class="text-sm text-blue-300" id="formality-value">60%</span>
          </div>
          <div class="flex items-center">
            <span class="text-xs text-gray-500 mr-2">Casual</span>
            <input type="range" id="formality-slider" class="personality-slider flex-grow" 
                  data-trait="formality" min="0" max="100" value="60">
            <span class="text-xs text-gray-500 ml-2">Formal</span>
          </div>
        </div>
        
        <!-- Encouragement Level -->
        <div class="personality-slider-container">
          <div class="flex justify-between mb-1">
            <label for="encouragement-slider" class="text-sm">Encouragement</label>
            <span class="text-sm text-blue-300" id="encouragement-value">75%</span>
          </div>
          <div class="flex items-center">
            <span class="text-xs text-gray-500 mr-2">Challenging</span>
            <input type="range" id="encouragement-slider" class="personality-slider flex-grow" 
                  data-trait="encouragement" min="0" max="100" value="75">
            <span class="text-xs text-gray-500 ml-2">Supportive</span>
          </div>
        </div>
        
        <!-- Detail Level -->
        <div class="personality-slider-container">
          <div class="flex justify-between mb-1">
            <label for="detail-slider" class="text-sm">Detail Level</label>
            <span class="text-sm text-blue-300" id="detail-value">65%</span>
          </div>
          <div class="flex items-center">
            <span class="text-xs text-gray-500 mr-2">Concise</span>
            <input type="range" id="detail-slider" class="personality-slider flex-grow" 
                  data-trait="detail" min="0" max="100" value="65">
            <span class="text-xs text-gray-500 ml-2">Detailed</span>
          </div>
        </div>
      </div>
      
      <!-- Visual Preview -->
      <div class="mt-6 bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-blue-800">
        <h4 class="text-sm font-medium mb-2 text-blue-300">Response Preview:</h4>
        <div id="personality-preview" class="text-sm text-gray-300 p-3 bg-gray-900 bg-opacity-50 rounded">
          <p>Your physical training shows moderate progress, but there's room for improvement in consistency and intensity.</p>
          <p>Think of your training like preparing for a zero-gravity marathon - one small step at a time!</p>
        </div>
        <div class="text-xs text-gray-500 mt-2">
          <i class="fas fa-info-circle mr-1"></i> This preview reflects how STELLA will respond with current settings.
        </div>
      </div>
      
      <!-- Update Button -->
      <button id="update-personality-btn" class="mt-4 bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-medium transition-colors w-full">
        Update STELLA Personality
      </button>
    </div>
  </div>
</div>

<!-- Space Readiness Countdown Section -->
<div class="col-span-12 lg:col-span-5 mb-6">
  <div class="mission-control-card p-6 h-full">
    <div class="flex items-center mb-6">
      <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
      </div>
      <h2 class="text-2xl font-bold text-blue-400">Countdown to Space Readiness</h2>
    </div>
    
    <!-- Need assessment notification -->
    <div class="bg-indigo-900 bg-opacity-20 border border-indigo-500 border-opacity-20 rounded-lg p-4 mb-4">
      <div class="flex items-start">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <p class="text-indigo-300 text-sm">Complete your initial assessment to begin your countdown and unlock your personal space readiness timeline.</p>
      </div>
    </div>
    
    <!-- Countdown Boxes -->
    <div class="grid grid-cols-6 gap-2 mb-6 countdown-boxes">
      <!-- Years -->
      <div class="countdown-digit-box bg-blue-900 bg-opacity-40 border border-blue-800 p-3 rounded-lg text-center">
        <div class="text-3xl font-bold text-white" id="countdown-years">--</div>
        <p class="text-xs text-blue-200 mt-1">Years</p>
      </div>
      
      <!-- Weeks -->
      <div class="countdown-digit-box bg-blue-900 bg-opacity-40 border border-blue-800 p-3 rounded-lg text-center">
        <div class="text-3xl font-bold text-white" id="countdown-weeks">--</div>
        <p class="text-xs text-blue-200 mt-1">Weeks</p>
      </div>
      
      <!-- Days -->
      <div class="countdown-digit-box bg-blue-900 bg-opacity-40 border border-blue-800 p-3 rounded-lg text-center">
        <div class="text-3xl font-bold text-white" id="countdown-days">--</div>
        <p class="text-xs text-blue-200 mt-1">Days</p>
      </div>
      
      <!-- Hours -->
      <div class="countdown-digit-box bg-blue-900 bg-opacity-40 border border-blue-800 p-3 rounded-lg text-center">
        <div class="text-3xl font-bold text-white" id="countdown-hours">--</div>
        <p class="text-xs text-blue-200 mt-1">Hours</p>
      </div>
      
      <!-- Minutes -->
      <div class="countdown-digit-box bg-blue-900 bg-opacity-40 border border-blue-800 p-3 rounded-lg text-center">
        <div class="text-3xl font-bold text-white" id="countdown-minutes">--</div>
        <p class="text-xs text-blue-200 mt-1">Minutes</p>
      </div>
      
      <!-- Seconds -->
      <div class="countdown-digit-box bg-blue-900 bg-opacity-40 border border-blue-800 p-3 rounded-lg text-center">
        <div class="text-3xl font-bold text-white" id="countdown-seconds">--</div>
        <p class="text-xs text-blue-200 mt-1">Seconds</p>
      </div>
    </div>
    
    <!-- Countdown Info -->
    <div class="bg-blue-900 bg-opacity-20 p-4 rounded-lg">
      <h3 class="text-lg font-semibold text-blue-300 mb-2">Projected Completion</h3>
      <div class="text-xl font-bold text-white mb-3" id="countdown-projected-date">--</div>
      
      <h3 class="text-lg font-semibold text-blue-300 mb-2">Accelerate Your Timeline</h3>
      <p class="text-sm text-gray-400 mb-3">Your journey to space can be accelerated by:</p>
      
      <div id="countdown-acceleration">
        <ul class="text-sm text-gray-400 space-y-1">
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            Completing all training modules
          </li>
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            Participating in mission simulations
          </li>
          <li class="flex items-start">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
            </svg>
            Completing physical training exercises
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>
    
    <!-- Next Milestone -->
    <div class="countdown-info-box bg-blue-900 bg-opacity-30 border border-blue-800 p-4 rounded-lg">
      <h4 class="text-lg font-semibold text-blue-300 mb-2">Next Milestone</h4>
      <div class="text-xl font-bold text-white mb-1" id="countdown-milestone">Intermediate Training</div>
      <p class="text-sm text-blue-200 mb-3"><span id="countdown-milestone-days">545</span> days remaining</p>
      
      <div class="bg-blue-900 bg-opacity-40 p-3 rounded border border-blue-700 mt-2">
        <h5 class="text-sm font-semibold text-blue-300 mb-1">Milestone Description</h5>
        <p class="text-xs text-blue-100" id="countdown-milestone-description">Completed basic training fundamentals and ready for advanced modules</p>
      </div>
    </div>
    
    <!-- Acceleration Opportunities -->
    <div class="countdown-info-box bg-blue-900 bg-opacity-30 border border-blue-800 p-4 rounded-lg">
      <h4 class="text-lg font-semibold text-blue-300 mb-2">Acceleration Opportunities</h4>
      <ul class="text-sm text-blue-100 space-y-2" id="countdown-acceleration">
        <li class="flex items-center">
          <span class="bg-green-600 rounded-full w-2 h-2 mr-2"></span>
          <span class="flex-grow">Complete assessments</span>
          <span class="text-green-400">-5.2 days</span>
        </li>
        <li class="flex items-center">
          <span class="bg-green-600 rounded-full w-2 h-2 mr-2"></span>
          <span class="flex-grow">Daily physical training</span>
          <span class="text-green-400">-3.5 days</span>
        </li>
        <li class="flex items-center">
          <span class="bg-green-600 rounded-full w-2 h-2 mr-2"></span>
          <span class="flex-grow">Mission simulations</span>
          <span class="text-green-400">-8.0 days</span>
        </li>
      </ul>
    </div>
    
    <!-- Timeline Impact -->
    <div class="countdown-info-box bg-blue-900 bg-opacity-30 border border-blue-800 p-4 rounded-lg">
      <h4 class="text-lg font-semibold text-blue-300 mb-2">Timeline Impact</h4>
      <div class="bg-blue-900 bg-opacity-40 p-3 rounded border border-blue-700">
        <p class="text-sm text-blue-100" id="countdown-impact-description">Regular physical training can significantly accelerate your space readiness</p>
        <div class="flex items-center justify-between mt-2">
          <span class="text-xs text-blue-200">Potential reduction:</span>
          <span class="text-green-400 font-bold" id="countdown-impact-change">-3.5 days</span>
        </div>
      </div>
    </div>
    
    <!-- Recent Reductions -->
    <div class="countdown-info-box bg-blue-900 bg-opacity-30 border border-blue-800 p-4 rounded-lg col-span-2">
      <h4 class="text-lg font-semibold text-blue-300 mb-2">Recent Activity</h4>
      <div class="space-y-2" id="countdown-history">
        <div class="grid grid-cols-3 text-xs text-blue-200 font-semibold mb-1">
          <div>Date</div>
          <div>Activity</div>
          <div class="text-right">Reduction</div>
        </div>
        <div class="h-px bg-blue-800 mb-2"></div>
        <div class="grid grid-cols-3 text-sm">
          <div class="text-blue-200">Mar 28, 2025</div>
          <div class="text-blue-100">Physical Training</div>
          <div class="text-green-400 text-right">-2.5 days</div>
        </div>
        <div class="grid grid-cols-3 text-sm">
          <div class="text-blue-200">Mar 26, 2025</div>
          <div class="text-blue-100">Assessment</div>
          <div class="text-green-400 text-right">-4.8 days</div>
        </div>
        <div class="grid grid-cols-3 text-sm">
          <div class="text-blue-200">Mar 24, 2025</div>
          <div class="text-blue-100">Mission Simulation</div>
          <div class="text-green-400 text-right">-7.2 days</div>
        </div>
      </div>
    </div>
  </div>
</div>
        <!-- Countdown to Space Readiness -->
        <div class="col-span-12 lg:col-span-5 mb-6">
          <div class="mission-control-card p-6 h-full">
            <div class="flex items-center mb-6">
              <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <h2 class="text-2xl font-bold text-blue-400">Countdown to Space Readiness</h2>
            </div>
            
            <!-- Need assessment notification -->
            <div class="bg-indigo-900 bg-opacity-20 border border-indigo-500 border-opacity-20 rounded-lg p-4 mb-4">
              <div class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <p class="text-indigo-300 text-sm">Complete your initial assessment to begin your countdown and unlock your personal space readiness timeline.</p>
              </div>
            </div>
            
            <div class="grid grid-cols-3 gap-4 mb-4">
              <div class="countdown-box">
                <div class="countdown-value">--</div>
                <div class="countdown-label">YEARS</div>
              </div>
              <div class="countdown-box">
                <div class="countdown-value">--</div>
                <div class="countdown-label">MONTHS</div>
              </div>
              <div class="countdown-box">
                <div class="countdown-value">--</div>
                <div class="countdown-label">DAYS</div>
              </div>
            </div>
            
            <div class="mt-4 bg-blue-900 bg-opacity-20 p-4 rounded-lg">
              <h3 class="text-lg font-semibold text-blue-300 mb-2">Accelerate Your Timeline</h3>
              <p class="text-sm text-gray-400 mb-3">Your journey to space can be accelerated by:</p>
              <ul class="text-sm text-gray-400 space-y-1">
                <li class="flex items-start">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  Completing all training modules
                </li>
                <li class="flex items-start">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  Subscribing to Premium Tiers
                </li>
                <li class="flex items-start">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  Earning certifications & badges
                </li>
              </ul>
            </div>
          </div>
        </div>
        
        <!-- Assessment Section - Integrated with STELLA's guidance -->
        <div class="col-span-12 mb-6">
          <div class="mission-control-card p-6">
            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center">
                <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                  </svg>
                </div>
                <h2 class="text-2xl font-bold text-blue-400">Your Assessments</h2>
              </div>
              
              <div class="relative">
                <div class="absolute -top-2 -right-2 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-xs font-bold">1</div>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                </svg>
              </div>
            </div>
            
            <!-- Assessment Cards Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              <!-- Initial Assessment Card -->
              <div class="assessment-card p-5 border-l-4 border-blue-600">
                <div class="flex items-start mb-4">
                  <div class="assessment-icon mr-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold mb-1">Initial Readiness Assessment</h3>
                    <p class="text-sm text-gray-400">Establish your baseline space readiness profile</p>
                  </div>
                </div>
                
                <div class="mb-4 bg-blue-900 bg-opacity-10 rounded p-3">
                  <div class="flex justify-between text-sm mb-1">
                    <span>Status:</span>
                    <span class="text-red-400 font-medium">Not Started</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span>Estimated Time:</span>
                    <span>15 minutes</span>
                  </div>
                </div>
                
                <a href="/assessment/initial" id="start-assessment-btn" class="block w-full bg-blue-600 hover:bg-blue-700 text-center text-white py-2 rounded-lg font-medium transition-colors">
                  Start Assessment
                </a>
              </div>
              
              <!-- Physical Assessment Card -->
              <div class="assessment-card p-5 border-l-4 border-indigo-600 opacity-70">
                <div class="flex items-start mb-4">
                  <div class="assessment-icon mr-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold mb-1">Physical Fitness Assessment</h3>
                    <p class="text-sm text-gray-400">Evaluate your physical readiness for space</p>
                  </div>
                </div>
                
                <div class="mb-4 bg-blue-900 bg-opacity-10 rounded p-3">
                  <div class="flex justify-between text-sm mb-1">
                    <span>Status:</span>
                    <span class="text-yellow-400 font-medium">Locked</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span>Estimated Time:</span>
                    <span>20 minutes</span>
                  </div>
                </div>
                
                <button disabled class="block w-full bg-gray-700 cursor-not-allowed text-center text-gray-400 py-2 rounded-lg font-medium">
                  Complete Initial Assessment First
                </button>
              </div>
              
              <!-- Mental Assessment Card -->
              <div class="assessment-card p-5 border-l-4 border-purple-600 opacity-70">
                <div class="flex items-start mb-4">
                  <div class="assessment-icon mr-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold mb-1">Mental Resilience Assessment</h3>
                    <p class="text-sm text-gray-400">Evaluate your psychological readiness</p>
                  </div>
                </div>
                
                <div class="mb-4 bg-blue-900 bg-opacity-10 rounded p-3">
                  <div class="flex justify-between text-sm mb-1">
                    <span>Status:</span>
                    <span class="text-yellow-400 font-medium">Locked</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span>Estimated Time:</span>
                    <span>15 minutes</span>
                  </div>
                </div>
                
                <button disabled class="block w-full bg-gray-700 cursor-not-allowed text-center text-gray-400 py-2 rounded-lg font-medium">
                  Complete Initial Assessment First
                </button>
              </div>
              
              <!-- Technical Assessment Card -->
              <div class="assessment-card p-5 border-l-4 border-green-600 opacity-70">
                <div class="flex items-start mb-4">
                  <div class="assessment-icon mr-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold mb-1">Technical Skills Assessment</h3>
                    <p class="text-sm text-gray-400">Evaluate your technical aptitude</p>
                  </div>
                </div>
                
                <div class="mb-4 bg-blue-900 bg-opacity-10 rounded p-3">
                  <div class="flex justify-between text-sm mb-1">
                    <span>Status:</span>
                    <span class="text-yellow-400 font-medium">Locked</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span>Estimated Time:</span>
                    <span>25 minutes</span>
                  </div>
                </div>
                
                <button disabled class="block w-full bg-gray-700 cursor-not-allowed text-center text-gray-400 py-2 rounded-lg font-medium">
                  Complete Initial Assessment First
                </button>
              </div>
              
              <!-- EVA Readiness Card -->
              <div class="assessment-card p-5 border-l-4 border-yellow-600 opacity-70">
                <div class="flex items-start mb-4">
                  <div class="assessment-icon mr-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold mb-1">EVA Readiness Assessment</h3>
                    <p class="text-sm text-gray-400">Measure your spacewalk readiness</p>
                  </div>
                </div>
                
                <div class="mb-4 bg-blue-900 bg-opacity-10 rounded p-3">
                  <div class="flex justify-between text-sm mb-1">
                    <span>Status:</span>
                    <span class="text-yellow-400 font-medium">Locked</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span>Estimated Time:</span>
                    <span>30 minutes</span>
                  </div>
                </div>
                
                <button disabled class="block w-full bg-gray-700 cursor-not-allowed text-center text-gray-400 py-2 rounded-lg font-medium">
                  Complete Initial Assessment First
                </button>
              </div>
              
              <!-- Mission-Specific Card -->
              <div class="assessment-card p-5 border-l-4 border-pink-600 opacity-70">
                <div class="flex items-start mb-4">
                  <div class="assessment-icon mr-3 flex-shrink-0">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" />
                    </svg>
                  </div>
                  <div>
                    <h3 class="text-lg font-semibold mb-1">Mission Core & Balance</h3>
                    <p class="text-sm text-gray-400">Assess your core strength readiness</p>
                  </div>
                </div>
                
                <div class="mb-4 bg-blue-900 bg-opacity-10 rounded p-3">
                  <div class="flex justify-between text-sm mb-1">
                    <span>Status:</span>
                    <span class="text-yellow-400 font-medium">Locked</span>
                  </div>
                  <div class="flex justify-between text-sm">
                    <span>Estimated Time:</span>
                    <span>15 minutes</span>
                  </div>
                </div>
                
                <button disabled class="block w-full bg-gray-700 cursor-not-allowed text-center text-gray-400 py-2 rounded-lg font-medium">
                  Complete Initial Assessment First
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Training Progress & Mission Status -->
        <div class="col-span-12 lg:col-span-7 mb-6">
          <div class="mission-control-card p-6 h-full">
            <div class="flex items-center mb-6">
              <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
              </div>
              <h2 class="text-2xl font-bold text-blue-400">Training Progress</h2>
            </div>
            
            <!-- Need assessment notification -->
            <!-- Need assessment notification -->
            <div class="bg-indigo-900 bg-opacity-20 border border-indigo-500 border-opacity-20 rounded-lg p-4 mb-4">
              <div class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <p class="text-indigo-300 text-sm">Complete your initial assessment to unlock personalized training modules and track your progress.</p>
              </div>
            </div>
            
            <!-- Module Progress Grid (Locked) -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 opacity-70">
              <!-- Physical Training -->
              <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-gray-700">
                <div class="flex justify-between items-center mb-2">
                  <h3 class="font-semibold">Physical Training</h3>
                  <span class="text-yellow-400 text-xs">LOCKED</span>
                </div>
                <div class="progress-bar mb-2">
                  <div class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-400">
                  <span>0% Complete</span>
                  <span>0/4 Missions</span>
                </div>
              </div>
              
              <!-- Mental Fitness -->
              <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-gray-700">
                <div class="flex justify-between items-center mb-2">
                  <h3 class="font-semibold">Mental Fitness</h3>
                  <span class="text-yellow-400 text-xs">LOCKED</span>
                </div>
                <div class="progress-bar mb-2">
                  <div class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-400">
                  <span>0% Complete</span>
                  <span>0/5 Missions</span>
                </div>
              </div>
              
              <!-- Technical Skills -->
              <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-gray-700">
                <div class="flex justify-between items-center mb-2">
                  <h3 class="font-semibold">Technical Skills</h3>
                  <span class="text-yellow-400 text-xs">LOCKED</span>
                </div>
                <div class="progress-bar mb-2">
                  <div class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-400">
                  <span>0% Complete</span>
                  <span>0/6 Missions</span>
                </div>
              </div>
              
              <!-- EVA Training -->
              <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-gray-700">
                <div class="flex justify-between items-center mb-2">
                  <h3 class="font-semibold">EVA Training</h3>
                  <span class="text-yellow-400 text-xs">LOCKED</span>
                </div>
                <div class="progress-bar mb-2">
                  <div class="progress-fill" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-400">
                  <span>0% Complete</span>
                  <span>0/3 Missions</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Certifications & STELLA Recommendations -->
        <div class="col-span-12 lg:col-span-5 mb-6">
          <div class="mission-control-card p-6 h-full">
            <div class="flex items-center mb-6">
              <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
                </svg>
              </div>
              <h2 class="text-2xl font-bold text-blue-400">STELLA Recommendations</h2>
            </div>
            
            <div class="space-y-4">
              <!-- STELLA's Top Recommendations -->
              <div class="bg-blue-900 bg-opacity-10 rounded-lg p-4 border border-blue-900 border-opacity-20">
                <h3 class="font-semibold text-blue-300 mb-2">Today's Recommendations</h3>
                <ul class="space-y-3">
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                    </svg>
                    <span>Complete your initial assessment to unlock your personalized training plan</span>
                  </li>
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <span>Schedule 15 minutes to complete your assessment today</span>
                  </li>
                  <li class="flex items-start">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    <span>Consider upgrading to Premium for 35% faster space readiness</span>
                  </li>
                </ul>
              </div>
              
              <!-- Presidential Briefing Preview -->
              <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-gray-700">
                <div class="flex justify-between items-center mb-2">
                  <h3 class="font-semibold">Presidential Daily Briefing</h3>
                  <span class="text-yellow-400 text-xs">LOCKED</span>
                </div>
                <p class="text-sm text-gray-400">Complete your assessment to unlock classified daily mission briefings directly from SharedStars Command.</p>
              </div>
              
              <!-- Upcoming Events -->
              <div class="bg-gray-800 bg-opacity-50 rounded-lg p-4 border border-gray-700">
                <h3 class="font-semibold mb-2">Upcoming Events</h3>
                <ul class="space-y-3 text-sm">
                  <li class="flex items-start">
                    <div class="bg-blue-900 bg-opacity-30 text-blue-400 rounded-full w-8 h-8 flex items-center justify-center mr-2 flex-shrink-0">
                      15
                    </div>
                    <div>
                      <p class="font-medium">Live Astronaut Q&A</p>
                      <p class="text-gray-400">March 15, 2025 - 6:00 PM ET</p>
                    </div>
                  </li>
                  <li class="flex items-start">
                    <div class="bg-blue-900 bg-opacity-30 text-blue-400 rounded-full w-8 h-8 flex items-center justify-center mr-2 flex-shrink-0">
                      22
                    </div>
                    <div>
                      <p class="font-medium">VR Space Station Tour</p>
                      <p class="text-gray-400">March 22, 2025 - 2:00 PM ET</p>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Mission Status Section -->
        <div class="col-span-12 mb-6">
          <div class="mission-control-card p-6">
            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center">
                <div class="w-12 h-12 bg-blue-900 bg-opacity-50 rounded-full flex items-center justify-center mr-4">
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                  </svg>
                </div>
                <h2 class="text-2xl font-bold text-blue-400">Mission Status</h2>
              </div>
            </div>
            
            <!-- Status Card -->
            <div class="bg-indigo-900 bg-opacity-20 border border-indigo-500 border-opacity-20 rounded-lg p-4 mb-4">
              <div class="flex items-start">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-indigo-400 mt-0.5 mr-2 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <p class="text-indigo-300">You're not yet eligible for advanced missions. Complete your initial assessment to unlock eligibility.</p>
              </div>
            </div>
            
            <!-- Next Steps -->
            <div class="bg-blue-900 bg-opacity-10 rounded-lg p-4 border border-blue-900 border-opacity-20">
              <h3 class="font-semibold text-blue-300 mb-2">Next Steps</h3>
              <ol class="space-y-3">
                <li class="flex items-start">
                  <div class="bg-blue-900 text-white rounded-full w-6 h-6 flex items-center justify-center mr-3 mt-0.5 flex-shrink-0">1</div>
                  <span>Complete your initial assessment</span>
                </li>
                <li class="flex items-start">
                  <div class="bg-gray-700 text-gray-300 rounded-full w-6 h-6 flex items-center justify-center mr-3 mt-0.5 flex-shrink-0">2</div>
                  <span class="text-gray-400">Receive your personalized training program</span>
                </li>
                <li class="flex items-start">
                  <div class="bg-gray-700 text-gray-300 rounded-full w-6 h-6 flex items-center justify-center mr-3 mt-0.5 flex-shrink-0">3</div>
                  <span class="text-gray-400">Begin your mission-specific training</span>
                </li>
                <li class="flex items-start">
                  <div class="bg-gray-700 text-gray-300 rounded-full w-6 h-6 flex items-center justify-center mr-3 mt-0.5 flex-shrink-0">4</div>
                  <span class="text-gray-400">Earn certifications and advance your space readiness</span>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
<!-- FOOTER -->
<footer class="relative bg-blue-950/90 text-white py-16 overflow-hidden">
  <!-- Animated Floating Particles -->
  <div class="absolute inset-0 overflow-hidden">
    <div class="absolute w-2 h-2 bg-blue-400/20 rounded-full animate-float-slow" style="top: 10%; left: 20%;"></div>
    <div class="absolute w-3 h-3 bg-purple-400/20 rounded-full animate-float-medium" style="top: 30%; right: 25%;"></div>
    <div class="absolute w-2 h-2 bg-blue-300/20 rounded-full animate-float-fast" style="bottom: 20%; left: 40%;"></div>
  </div>
  <div class="container mx-auto px-4 relative z-10">
    <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mb-12 text-center md:text-left">
      <!-- About -->
      <div>
        <h3 class="font-bold text-lg text-blue-400" data-i18n="footer.about.title">About</h3>
        <ul class="space-y-2 mt-4">
          <li><a href="/about.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.about.ourStory">Our Story</a></li>
          <li><a href="/academy.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.about.academy">StelTrek Academy</a></li>
        </ul>
      </div>
      <!-- Community -->
      <div>
        <h3 class="font-bold text-lg text-blue-400" data-i18n="footer.community.title">Community</h3>
        <ul class="space-y-2 mt-4">
          <li><a href="/events.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.community.events">Events</a></li>
          <li><a href="/forums.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.community.forums">Forums</a></li>
        </ul>
      </div>
      <!-- Resources -->
      <div>
        <h3 class="font-bold text-lg text-blue-400" data-i18n="footer.resources.title">Resources</h3>
        <ul class="space-y-2 mt-4">
          <li><a href="/faq.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.resources.faq">FAQ</a></li>
          <li><a href="/support.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.resources.support">Support</a></li>
        </ul>
      </div>
      <!-- Legal -->
      <div>
        <h3 class="font-bold text-lg text-blue-400" data-i18n="footer.legal.title">Legal</h3>
        <ul class="space-y-2 mt-4">
          <li><a href="/terms.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.legal.terms">Terms</a></li>
          <li><a href="/privacy.html" class="hover:text-blue-400 transition-colors" data-i18n="footer.legal.privacy">Privacy</a></li>
        </ul>
      </div>
    </div>
    
    <!-- Bottom section with copyright and social media -->
    <div class="mt-12 pt-8 border-t border-blue-900/20 flex flex-col md:flex-row justify-between items-center">
      <p class="text-gray-500">Â© 2025 Celestial Technologies, LLC. All rights reserved.</p>
      
      <!-- All 7 social media links -->
      <div class="flex space-x-4 mt-4 md:mt-0">
        <!-- LinkedIn -->
        <a href="https://www.linkedin.com/company/106241890" class="text-gray-400 hover:text-blue-400" aria-label="LinkedIn">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
        </a>
        
        <!-- Twitter/X -->
        <a href="https://x.com/SharedStars" class="text-gray-400 hover:text-blue-400" aria-label="Twitter">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
        </a>
        
        <!-- Facebook -->
        <a href="https://www.facebook.com/SharedStars" class="text-gray-400 hover:text-blue-400" aria-label="Facebook">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg>
        </a>
        
        <!-- Instagram -->
        <a href="https://www.instagram.com/sharedstarsacademy/" class="text-gray-400 hover:text-blue-400" aria-label="Instagram">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
        </a>
        
        <!-- Telegram -->
        <a href="https://t.me/SharedStars" class="text-gray-400 hover:text-blue-400" aria-label="Telegram">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0c-6.626 0-12 5.372-12 12 0 6.627 5.374 12 12 12 6.627 0 12-5.373 12-12 0-6.628-5.373-12-12-12zm3.224 17.871c.188.133.43.166.646.085.215-.082.374-.253.463-.489.089-.236.089-.498 0-.734l-1.74-4.36 4.4-2.507c.466-.265.466-.934 0-1.199l-9.65-5.514c-.465-.266-1.048.055-1.047.577l.072 12.71c0 .522.583.843 1.048.577l3.293-1.879zm-8.791-7.414l2.083 1.188-.759 1.329-1.324-.755v-1.762zm6.442 7.385l-1.621.925c-.961.548-2.132-.106-2.132-1.186l-.04-6.99 3.793 7.251z"/></svg>
        </a>
        
        <!-- TikTok -->
        <a href="https://www.tiktok.com/@sharedstarsacademy" class="text-gray-400 hover:text-blue-400" aria-label="TikTok">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12.525.02c1.31-.02 2.61-.01 3.91-.02.08 1.53.63 3.09 1.75 4.17 1.12 1.11 2.7 1.62 4.24 1.79v4.03c-1.44-.05-2.89-.35-4.2-.97-.57-.26-1.1-.59-1.62-.93-.01 2.92.01 5.84-.02 8.75-.08 1.4-.54 2.79-1.35 3.94-1.31 1.92-3.58 3.17-5.91 3.21-1.43.08-2.86-.31-4.08-1.03-2.02-1.19-3.44-3.37-3.65-5.71-.02-.5-.03-1-.01-1.49.18-1.9 1.12-3.72 2.58-4.96 1.66-1.44 3.98-2.13 6.15-1.72.02 1.48-.04 2.96-.04 4.44-.99-.32-2.15-.23-3.02.37-.63.41-1.11 1.04-1.36 1.75-.21.51-.15 1.07-.14 1.61.24 1.64 1.82 3.02 3.5 2.87 1.12-.01 2.19-.66 2.77-1.61.19-.33.4-.67.41-1.06.1-1.79.06-3.57.07-5.36.01-4.03-.01-8.05.02-12.07z"/></svg>
        </a>
        
        <!-- YouTube -->
        <a href="https://www.youtube.com/@SharedStarsAcademy" class="text-gray-400 hover:text-blue-400" aria-label="YouTube">
          <svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
        </a>
      </div>
    </div>
  </div>
</footer>
<!-- JavaScript -->
<script src="/js/stella-core.js"></script>
<script src="/js/stella-integration.js"></script>
<script src="/js/countdown.js"></script>
<script src="/js/languageManager.js" defer></script>
<!-- Add these before your closing body tag if not already present -->
<script src="/js/progressAssessment.js"></script>
<script src="/js/progressChart.js"></script>
<script src="/js/visualizations/ProgressTracker.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Initialize STELLA
  setupSTELLAIntegration();
  
  // Initialize personality sliders
  setupPersonalitySliders();
  
  // Initialize countdown
  setupCountdown();
});

/**
 * Setup STELLA AI integration
 */
function setupSTELLAIntegration() {
  // Get STELLA elements
  const stellaInput = document.getElementById('stella-question');
  const stellaSendButton = document.getElementById('send-to-stella');
  const stellaConversation = document.querySelector('.stella-conversation');
  
  if (!stellaInput || !stellaSendButton) return;
  
  // Connect to STELLA API
  fetch('/api/stella/connect', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      userId: getUserId()
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      console.log('Connected to STELLA AI');
      // Store session ID
      localStorage.setItem('stella_session_id', data.sessionId);
      
      // Setup event handlers
      stellaSendButton.addEventListener('click', sendMessageToSTELLA);
      stellaInput.addEventListener('keydown', event => {
        if (event.key === 'Enter') {
          sendMessageToSTELLA();
        }
      });
      
      // Apply stored personality if available
      if (data.personality) {
        updatePersonalitySliders(data.personality);
      }
    } else {
      console.error('Failed to connect to STELLA AI');
    }
  })
  .catch(error => {
    console.error('Error connecting to STELLA:', error);
  });
}

/**
 * Get user ID from local storage or generate a new one
 */
function getUserId() {
  let userId = localStorage.getItem('user_id');
  if (!userId) {
    userId = 'user_' + Date.now();
    localStorage.setItem('user_id', userId);
  }
  return userId;
}

/**
 * Send message to STELLA AI
 */
function sendMessageToSTELLA() {
  const stellaInput = document.getElementById('stella-question');
  const stellaConversation = document.querySelector('.stella-conversation');
  const question = stellaInput.value.trim();
  
  if (!question) return;
  
  // Clear input
  stellaInput.value = '';
  
  // Display user message
  displayMessage('user', question);
  
  // Show typing indicator
  displayTypingIndicator();
  
  // Get session ID from localStorage
  const sessionId = localStorage.getItem('stella_session_id') || `session_${Date.now()}`;
  
  // Get conversation history
  const conversationHistory = JSON.parse(localStorage.getItem('stella_conversation_history') || '[]');
  
  // Call STELLA API
  fetch('/api/stella/guidance', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      userId: getUserId(),
      question: question,
      context: {
        currentPage: 'mission-control',
        moduleContext: getCurrentModule()
      },
      sessionId: sessionId,
      conversationHistory: conversationHistory
    })
  })
  .then(response => response.json())
  .then(data => {
    // Remove typing indicator
    removeTypingIndicator();
    
    if (data.success) {
      // Display STELLA response
      displayMessage('stella', data.guidance.message);
      
      // Store feedback token for later use
      if (data.feedbackToken) {
        stellaConversation.lastElementChild.dataset.feedbackToken = data.feedbackToken;
      }
      
      // Update conversation history
      conversationHistory.push({
        role: 'user',
        content: question
      });
      conversationHistory.push({
        role: 'assistant',
        content: data.guidance.message
      });
      
      // Limit history to last 10 messages
      while (conversationHistory.length > 10) {
        conversationHistory.shift();
      }
      
      localStorage.setItem('stella_conversation_history', JSON.stringify(conversationHistory));
      
      // Display action items if any
      if (data.guidance.actionItems && data.guidance.actionItems.length > 0) {
        displayActionItems(data.guidance.actionItems);
      }
      
      // Update countdown if provided
      if (data.countdown && data.countdown.timelineImpact) {
        updateCountdown(data.countdown);
      }
    } else {
      displayMessage('system', "I'm having trouble processing your request. Please try again.");
    }
  })
  .catch(error => {
    console.error('Error sending message to STELLA:', error);
    removeTypingIndicator();
    displayMessage('system', "Connection to mission control interrupted. Please try again.");
  });
}

/**
 * Display message in conversation
 */
function displayMessage(sender, message) {
  const stellaConversation = document.querySelector('.stella-conversation');
  const messageElement = document.createElement('div');
  messageElement.classList.add('message', sender);
  
  const content = document.createElement('div');
  content.classList.add('message-content');
  content.innerHTML = message;
  
  messageElement.appendChild(content);
  
  // Add feedback buttons for STELLA messages
  if (sender === 'stella') {
    const feedbackElement = document.createElement('div');
    feedbackElement.classList.add('message-feedback');
    feedbackElement.innerHTML = `
      <button class="feedback-helpful" title="Helpful"><i class="fas fa-thumbs-up"></i></button>
      <button class="feedback-unhelpful" title="Not Helpful"><i class="fas fa-thumbs-down"></i></button>
    `;
    messageElement.appendChild(feedbackElement);
    
    // Add event listeners for feedback
    setTimeout(() => {
      const helpfulBtn = messageElement.querySelector('.feedback-helpful');
      const unhelpfulBtn = messageElement.querySelector('.feedback-unhelpful');
      
      helpfulBtn.addEventListener('click', () => provideFeedback(messageElement, true));
      unhelpfulBtn.addEventListener('click', () => provideFeedback(messageElement, false));
    }, 100);
  }
  
  stellaConversation.appendChild(messageElement);
  
  // Scroll to bottom
  stellaConversation.scrollTop = stellaConversation.scrollHeight;
}

/**
 * Display typing indicator
 */
function displayTypingIndicator() {
  const stellaConversation = document.querySelector('.stella-conversation');
  const typingIndicator = document.createElement('div');
  typingIndicator.classList.add('message', 'stella', 'typing-indicator');
  typingIndicator.innerHTML = '<div class="dot"></div><div class="dot"></div><div class="dot"></div>';
  
  stellaConversation.appendChild(typingIndicator);
  stellaConversation.scrollTop = stellaConversation.scrollHeight;
}

/**
 * Remove typing indicator
 */
function removeTypingIndicator() {
  const typingIndicator = document.querySelector('.typing-indicator');
  if (typingIndicator) {
    typingIndicator.remove();
  }
}

/**
 * Display action items
 */
function displayActionItems(actionItems) {
  const stellaConversation = document.querySelector('.stella-conversation');
  const lastMessage = stellaConversation.lastElementChild;
  
  const actionsElement = document.createElement('div');
  actionsElement.classList.add('action-items');
  
  let actionsHTML = '<h4>Recommended Actions:</h4><ul>';
  actionItems.forEach(item => {
    actionsHTML += `<li>${item}</li>`;
  });
  actionsHTML += '</ul>';
  
  actionsElement.innerHTML = actionsHTML;
  lastMessage.appendChild(actionsElement);
}

/**
 * Provide feedback on STELLA response
 */
function provideFeedback(messageElement, helpful) {
  const feedbackToken = messageElement.dataset.feedbackToken;
  if (!feedbackToken) {
    console.warn('No feedback token available for this message');
    return;
  }
  
  // Disable feedback buttons
  const feedbackButtons = messageElement.querySelectorAll('.message-feedback button');
  feedbackButtons.forEach(btn => btn.disabled = true);
  
  // Show feedback submitted message
  const feedbackElement = messageElement.querySelector('.message-feedback');
  feedbackElement.innerHTML = '<span class="feedback-submitted">Feedback submitted</span>';
  
  // Send feedback to API
  fetch('/api/stella/feedback', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      feedbackToken: feedbackToken,
      helpful: helpful,
      rating: helpful ? 4 : 2
    })
  })
  .then(response => response.json())
  .then(data => {
    console.log('Feedback submitted:', data);
  })
  .catch(error => {
    console.error('Error submitting feedback:', error);
  });
}

/**
 * Setup personality sliders
 */
function setupPersonalitySliders() {
  const sliders = document.querySelectorAll('.personality-slider');
  const updateButton = document.getElementById('update-personality-btn');
  
  if (!sliders.length || !updateButton) return;
  
  // Add event listeners to all sliders
  sliders.forEach(slider => {
    const valueDisplay = document.getElementById(`${slider.dataset.trait}-value`);
    
    // Update display on change
    slider.addEventListener('input', () => {
      if (valueDisplay) {
        valueDisplay.textContent = `${slider.value}%`;
      }
      updatePersonalityPreview();
    });
  });
  
  // Add event listener to update button
  updateButton.addEventListener('click', updatePersonality);
  
  // Initial preview update
  updatePersonalityPreview();
}

/**
 * Update personality sliders from values
 */
function updatePersonalitySliders(traits) {
  for (const [trait, value] of Object.entries(traits)) {
    const slider = document.querySelector(`.personality-slider[data-trait="${trait}"]`);
    const valueDisplay = document.getElementById(`${trait}-value`);
    
    if (slider) {
      slider.value = value;
      if (valueDisplay) {
        valueDisplay.textContent = `${value}%`;
      }
    }
  }
  
  updatePersonalityPreview();
}

/**
 * Update personality preview
 */
function updatePersonalityPreview() {
  const previewElement = document.getElementById('personality-preview');
  if (!previewElement) return;
  
  // Get current values
  const honesty = getSliderValue('honesty');
  const humor = getSliderValue('humor');
  const formality = getSliderValue('formality');
  const encouragement = getSliderValue('encouragement');
  const detail = getSliderValue('detail');
  
  // Generate preview text
  let preview = '<p>';
  
  // Base message
  preview += 'Your physical training shows moderate progress';
  
  // Honesty adjustment
  if (honesty > 80) {
    preview += ', but your performance is significantly below recommended levels';
  } else if (honesty > 50) {
    preview += ', but there\'s room for improvement in consistency and intensity';
  } else {
    preview += ' and you\'re doing quite well with your exercise regimen';
  }
  
  preview += '.</p>';
  
  // Detail adjustment
  if (detail > 80) {
    preview += '<p>Your cardiovascular endurance is at 68% of target levels, while strength training is at 72%. Focus on increasing workout frequency from 2 days to 4-5 days per week, with specific emphasis on core stability exercises for microgravity adaptation.</p>';
  } else if (detail > 50) {
    preview += '<p>Focus on increasing your workout frequency and adding more variety to target different muscle groups, especially your core for microgravity preparation.</p>';
  }
  
  // Humor and encouragement
  if (humor > 70) {
    preview += '<p>Think of your training like preparing for a zero-gravity marathon - one small step at a time! ðŸš€</p>';
  }
  
  if (encouragement > 70) {
    preview += '<p>You\'re making progress, and I\'m confident you\'ll reach your training goals with consistent effort!</p>';
  } else if (encouragement < 30) {
    preview += '<p>You need to significantly increase your effort level if you expect to complete this training program.</p>';
  }
  
  previewElement.innerHTML = preview;
}

/**
 * Get slider value
 */
function getSliderValue(trait) {
  const slider = document.querySelector(`.personality-slider[data-trait="${trait}"]`);
  return slider ? parseInt(slider.value) : 50;
}

/**
 * Update personality traits
 */
 function updatePersonality() {
  const updateButton = document.getElementById('update-personality-btn');
  if (updateButton) {
    updateButton.innerHTML = '<span class="spinner"></span> Updating...';
    updateButton.disabled = true;
  }
  
  // Get all trait values
  const traits = {
    honesty: getSliderValue('honesty'),
    humor: getSliderValue('humor'),
    formality: getSliderValue('formality'),
    encouragement: getSliderValue('encouragement'),
    detail: getSliderValue('detail')
  };
  
  // Send to API
  fetch('/api/stella/personality/update', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      userId: getUserId(),
      traits: traits
    })
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      // Show success notification
      showNotification('STELLA personality updated successfully!', 'success');
      
      // Update conversation with notification
      const stellaConversation = document.querySelector('.stella-conversation');
      if (stellaConversation) {
        displayMessage('system', 'STELLA personality settings have been updated. I\'ll adjust my communication style accordingly.');
        
        // Important: Immediately ask STELLA for a confirmation message to show the new personality
        fetch('/api/stella/guidance', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            userId: getUserId(),
            question: "Show me your new personality settings in action",
            context: {
              currentPage: 'personality-update',
              moduleContext: 'personality'
            },
            sessionId: localStorage.getItem('stella_session_id') || `session_${Date.now()}`
          })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            displayMessage('stella', data.guidance.message);
          }
        })
        .catch(error => console.error('Error getting personality demo:', error));
      }
    } else {
      showNotification('Failed to update STELLA personality', 'error');
    }
  })
  .catch(error => {
    console.error('Error updating personality:', error);
    showNotification('Error connecting to STELLA', 'error');
  })
  .finally(() => {
    if (updateButton) {
      updateButton.innerHTML = 'Update STELLA Personality';
      updateButton.disabled = false;
    }
  });
}

/**
 * Setup countdown display and update from API
 */
 function setupCountdown() {
  // Initial display update
  updateCountdownDisplay();
  
  // Update seconds counter every second
  setInterval(() => {
    const secondsElement = document.getElementById('countdown-seconds');
    if (secondsElement) {
      let seconds = parseInt(secondsElement.textContent);
      if (isNaN(seconds) || seconds === '--') seconds = 59;
      
      if (seconds <= 0) {
        seconds = 59;
        // Update minutes when seconds roll over
        updateMinutes();
      } else {
        seconds--;
      }
      secondsElement.textContent = seconds;
    }
  }, 1000);
  
  // Update full display every minute (keep your existing logic)
  setInterval(updateCountdownDisplay, 60000);

  // Fetch initial countdown data (keep your existing logic)
  fetch('/api/stella/countdown', {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json'
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success && data.countdown) {
      updateCountdownValues(data.countdown);
    }
  })
  .catch(error => {
    console.error('Error fetching countdown:', error);
  });
}

// Helper function to update minutes when seconds roll over
function updateMinutes() {
  const minutesElement = document.getElementById('countdown-minutes');
  if (minutesElement) {
    let minutes = parseInt(minutesElement.textContent);
    if (isNaN(minutes) || minutes === '--') minutes = 59;
    
    if (minutes <= 0) {
      minutes = 59;
      // Update hours when minutes roll over
      updateHours();
    } else {
      minutes--;
    }
    minutesElement.textContent = minutes;
  }
}

// Helper function to update hours when minutes roll over
function updateHours() {
  const hoursElement = document.getElementById('countdown-hours');
  if (hoursElement) {
    let hours = parseInt(hoursElement.textContent);
    if (isNaN(hours) || hours === '--') hours = 23;
    
    if (hours <= 0) {
      hours = 23;
      // Update days when hours roll over
      updateDays();
    } else {
      hours--;
    }
    hoursElement.textContent = hours;
  }
}

// Helper function to update days
function updateDays() {
  // This would need to update days, weeks, and years
  // For simplicity, we'll just reload the full countdown
  updateCountdownDisplay();
}
/**
 * Update countdown display based on stored values
 */
function updateCountdownDisplay() {
  // Get countdown elements
  const yearsElement = document.getElementById('countdown-years');
  const weeksElement = document.getElementById('countdown-weeks');
  const daysElement = document.getElementById('countdown-days');
  const hoursElement = document.getElementById('countdown-hours');
  const minutesElement = document.getElementById('countdown-minutes');
  const secondsElement = document.getElementById('countdown-seconds');
  const projectedDateElement = document.getElementById('countdown-projected-date');
  
  // Check if all elements exist
  if (!yearsElement || !daysElement) return;
  
  // Get countdown data from localStorage
  const countdownData = JSON.parse(localStorage.getItem('countdown_data') || 'null');
  
  if (countdownData && countdownData.daysRemaining) {
    // Calculate time units
    const totalDays = countdownData.daysRemaining;
    const years = Math.floor(totalDays / 365);
    const remainingDaysAfterYears = totalDays % 365;
    const weeks = Math.floor(remainingDaysAfterYears / 7);
    const days = Math.floor(remainingDaysAfterYears % 7);
    
    // Get current time for hours, minutes, seconds
    const now = new Date();
    const hours = 23 - now.getHours();
    const minutes = 59 - now.getMinutes();
    const seconds = 59 - now.getSeconds();
    
    // Update elements with values
    yearsElement.textContent = years;
    if (weeksElement) weeksElement.textContent = weeks;
    daysElement.textContent = days;
    if (hoursElement) hoursElement.textContent = hours;
    if (minutesElement) minutesElement.textContent = minutes;
    if (secondsElement) secondsElement.textContent = seconds;
    
    // Update projected date if element exists
    if (projectedDateElement && countdownData.projectedDate) {
      const date = new Date(countdownData.projectedDate);
      projectedDateElement.textContent = date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      });
    }
    
    // Update progress if elements exist
    const progressBarElement = document.getElementById('countdown-progress-bar');
    const progressPercentElement = document.getElementById('countdown-progress-percent');
    
    if (progressBarElement && progressPercentElement && countdownData.progress) {
      progressBarElement.style.width = `${countdownData.progress}%`;
      progressPercentElement.textContent = countdownData.progress.toFixed(1);
    }
    
    // Update milestone if elements exist
    const milestoneElement = document.getElementById('countdown-milestone');
    const milestoneDaysElement = document.getElementById('countdown-milestone-days');
    
    if (milestoneElement && milestoneDaysElement && countdownData.nextMilestone) {
      milestoneElement.textContent = countdownData.nextMilestone.name;
      milestoneDaysElement.textContent = countdownData.nextMilestone.daysRemaining;
    }
  } else {
    // No data available - show placeholder or assessment message
    yearsElement.textContent = '--';
    if (weeksElement) weeksElement.textContent = '--';
    daysElement.textContent = '--';
    if (hoursElement) hoursElement.textContent = '--';
    if (minutesElement) minutesElement.textContent = '--';
    if (secondsElement) secondsElement.textContent = '--';
  }
}

/**
 * Update countdown values from API response
 */
function updateCountdownValues(countdown) {
  // Store countdown data in localStorage
  localStorage.setItem('countdown_data', JSON.stringify(countdown));
  
  // Update display
  updateCountdownDisplay();
}

/**
 * Update countdown from STELLA response
 */
function updateCountdown(countdownData) {
  if (countdownData.timelineImpact) {
    // Show impact notification
    const message = `${countdownData.timelineImpact.impactDescription} (-${countdownData.timelineImpact.timelineChange} days)`;
    showNotification(message, 'success');
  }
  
  if (countdownData.countdownUpdate) {
    // Update stored countdown data
    const storedData = JSON.parse(localStorage.getItem('countdown_data') || '{}');
    const updatedData = {
      ...storedData,
      daysRemaining: countdownData.countdownUpdate.daysRemaining,
      totalReduction: countdownData.countdownUpdate.totalReduction,
      projectedDate: countdownData.countdownUpdate.projectedDate
    };
    
    localStorage.setItem('countdown_data', JSON.stringify(updatedData));
    
    // Update display
    updateCountdownDisplay();
  }
}

/**
 * Get current module context
 */
function getCurrentModule() {
  // You can customize this to get the current module from the page
  // For now, just return a default value
  return 'mission-control';
}

/**
 * Show notification
 */
function showNotification(message, type = 'info') {
  // Create notification element
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.innerHTML = `
    <div class="notification-content">
      ${message}
    </div>
    <button class="notification-close">&times;</button>
  `;
  
  // Add to document
  document.body.appendChild(notification);
  
  // Add close button handler
  const closeButton = notification.querySelector('.notification-close');
  if (closeButton) {
    closeButton.addEventListener('click', () => {
      notification.classList.add('fade-out');
      setTimeout(() => notification.remove(), 300);
    });
  }
  
  // Auto remove after 5 seconds
  setTimeout(() => {
    notification.classList.add('fade-out');
    setTimeout(() => notification.remove(), 300);
  }, 5000);
}
</script>
</body>
</html>